! = review this, commonly forgotten

NEED TO LEARN 
------------------
20% - Network Fundamentals
    /Spine Leaf architecture
    /Fiber
    /Ethernet shared media vs point-to-point
    /IPv6
    /IP commands for Mac OS
20% - Network Access
    /VLANs / Router on a Stick
    /CDP / LLDP
    /Etherchannel / LACP
    /STP
    /Wireless
    /LAG (wireless?)
    TACACS vs RADIUS
25% - IP Connectivity
    /routing table metric speeds
    /longest prefix match vs administrative distance vs metric protocol speed - who wins?
    /default vs network route vs host route
    /static routing and verification
    /    IPv6 routing    
    /OSPF
    purpose and cons of first hop redundancy protocols
10% - IP Services
    NAT
    NTP
    DHCP client and relay
    SNMP
    Syslog features, facilities and levels
    /QoS
    /SSH
    TFTP vs FTP
10% - Security
    VPNs
    /ACLs
    DHCP snooping
    /Dynamic ARP inspection
    AAA
    /local password commands


?ipv6 commands for switches vs routers?
/How does RIP create subnets automatically? It doesn't, it reads existing subnets configured on the interface ports
/How do you find what a port is connected to on the other side? show cdp neighbor
/How do people really diagnose spanning tree issues, since they'd have to piece together the web of designations from each switch?
/Multiple types of spanning trees on 1 switch? no
?/32 can be used for loopback addresses, since the data isn't going anywhere
?ARP packet bit diagram?
?ARP is only seen on the "directly connected networks"
/?How do I see what the native vlan is for this switch? It's per port.  On the interfaces switchport command.
/?when is "switchport trunk allowed vlan 2" necessary?  Do we have to whitelist each vlan for each port separately?
	no
?If a trunk port with VLAN 1 disabled is converted to a nontrunk port, it is added to the access VLAN. If the
access VLAN is set to 1, the port will be added to VLAN 1, regardless of the switchport trunk allowed
setting. The same is true for any VLAN that has been disabled on the port.?
?Does STP only extend one extra hop?  How does it scale with a web of switches?
?When a port is in Listening state due to STP transitions, does it not log new MAC addresses? Book acts like this is true
?Why does RSTP and RPVST+ use different destination MAC addresses?
?What exactly does a bpdu frame look like for STP, RSTP, and RPVST+?
?Do we ever have to change from a Cisco protocol to an IEEE protocol for compatibility?
?EtherChannel has it's own MAC or how does receiving switch add a MAC address to its table?


+Ports
- Well-known	0 - 1024
- Registered	1025 - 49151
- Private	49152 - 65535
- Open - application has requested and been granted use of a port number
- Closed - no application has requested use of that port number
- Listening - service running and possibly awaiting a connection, a type of open
- Blocked - packets are dropped containing layer-4 segment info directing to this port, by host-based or network firewall


+ Switch Framework from Cisco
- Access: Provides a connection point (access) for end-user devices. Does not forward frames between two other access switches under normal circumstances.
- Distribution: Provides an aggregation point for access switches, providing connectivity to the rest of the devices in the LAN, forwarding frames between switches, but not connecting directly to end-user devices.
- Core: Aggregates distribution switches in very large campus LANs, providing very high forwarding rates for the larger volume of traffic due to the size of the network.
Purpose
    - Core - forwarding as fast as possible
    - Distribution - filtering and policing
    - Access - connects to devices

- Spine Leaf - no core, all distribution switches are linked to all access switches


+ Cast ye networks
- What is sent to everything (flooded)? BUM traffic - Broadcast, Unknown Unicast, Multicast
- Broadcast - frame sent to all
!	- Routers do not forward broadcast traffic
- Unknown Unicast - going to a place but we can't find it, so send it everywhere
- Unicast - going to one specific destination, possibly across routers and switches 
- Multicast - one data stream sent looking for multiple destinations, rather than one for each.  Like tuning into a radio, because pc's subscribe to receive it.
	- certain ip addresses are reserved for multicasting, and a device can request to receive all streaming packets for that ip address, e.g. send the 224.0.0.5 packets to me too (OSPF hello multicast)
    - The routers send the 224.x.x.x packets to the multicast subscribed locations, and when they hit the last switch before the PC, a special MAC address is used which is then autoforwarded to ALL endpoints
    - nonsubscribing endpoints (PCs) connected to that last switch drop the packets, subscribing endpoints gladly receive them
- Anycast - IP address is shared by devices, packet sent to nearest one

+Terms
- interface = port = interface port = what you plug the cable into
	- switchport = interface port on a switch specifically
	- ethernet port = uses an ethernet cable
	- console port = special port to plug a cable into just for using the terminal and changing the device
	- serial port = serial cable port, old but still used as console ports
	- virtual port = digital port that transmits through a physical port or for routing on the switch itself, e.g. SVI or etherchannel
- 10/100/1000 Gi Gigabit Ethernet - can go at 10mb, 100mb, 1000mbs
- 10/100 Fa FastEthernet
- Te = Ten gig ethernet
- int Gi1/0/4 - interface gigabit ethernet port (group/module/number or just group/number)
	- modules are like segments that slide into the device to add more ports or special ports or functionality
- "a-full" and "a-100" are "autonegotiated full duplex" and "autonegotiated 100mbs"
- switchport type-interface = the "Te1/1/4" "Fe0/0/2" "Gi2/0/3" "TenGigaBitEthernet1/1/4" etc.
- commands start at >prompts, then #enabled prompts for more access, then (config)prompts for changing settings, then (config-if) for changing individual port settings
- # is the prompt for showing, #(config) is the prompt for doing, basically

+Menu Terminal Terminology
Switch> [this is normal mode]
Switch# [this is enable mode, superpowerful]
Switch(config) [this is the room for configuring the switch] [a.k.a. config mode or global configuration mode]
Switch(config-if) [configure interface mode, for configuring the specific port that a wire connects to] [you'll specify an individual port but it won't show which one when entered]
	ex. Switch> enable --> Switch# config terminal --> Switch(config) interface Gi0/1 --> Switch(config-if) [now you're in the menu for changing port Gi0/1 but it doesn't say that]
Switch(config-line) [this is the room for configuring a specific type of user connection on the switch, like rules for command-line sessions from ssh or a serial cable]
Switch(config-vlan) [for naming this specific vlan and other changes]

+OSI terms
- Layer 1 - bits    ethernet (1000 Base-T etc., the physical part), 802.11 wifi, bluetooth
- Layer 2 - Frame	ethernet frame
- Layer 3 - Packet	ip packet
- Layer 4 - Segment	http segment
    also Layer 4 - datagram - UDP
- Layer 5+ - Data	

+Encapsulation
- frame - header and footer
- everything else - header

+ The DHCP server, when there is an IP address conflict, removes the IP addresses until it's fixed

+ IPv6 doesn't have broadcast, since multicast is better anyways

+ Cut-through provides the lowest-latency switching available. It forwards Ethernet packets faster than any other method, because it only waits to read the destination MAC address before forwarding.

+ Storage Area Network

+ Storage Path vs. Network Path

+ In-band management access vs. Out-of-Band management access - access to the networking device using the normal user network infrastructure, versus access separate from normal infrastructure such as a different ethernet port specifically labeled "management" as a reliable independent access method for reconfiguring the devices when the normal network fails.

+ Container - assigns the middle ip octect for computers in a network.
	-Must be reset occasionally and maybe not all computers are on the list anymore

+ Subnet vs. VLAN - subnet is splitting of the ip address, VLAN is restricting traffic to certain paths
	VLAN is layer 2, subnet is layer 3

+ Layer 2 Switch vs Layer 3 Switch/Router - Switches send to ports based on the destination MAC address, Routers send to next-hop IPs based on the destination IP address.
!    - Layer 2 Switch still has one IP to enable remote management, therefore needs a default gateway configured as well!

!+ Layer 3 Switch vs Router
	- Router can sometimes host as a VPN server, which a Layer 3 Switch can't do it.  It can route, but can't host a VPN.
	- Layer 3 switchprort, if routed, needs "no shut"
	- Layer 3 switchport needs ip address configged
	- Layer 3 doesn't care about spanning-tree
	- Layer 3 doesn't forward traffic based on MAC address, it forwards based on IP address
	- Layer 3 doesn't use a MAC table, it uses an ARP table
	- Layer 3 probably creates more subnets just by being there, it's one more router-to-router connection
    - Routers don't broadcast outside of their network, they drop all packets with ip addresses outside of their network
        - DHCP port 67 and 68 are detected and work differently
    - Routers only have access ports, no trunking. Even SVI ports are just access ports
    - Routers don't have native vlans, only explicit vlans because they only use access ports, not trunk ports

+VLANs
	- 802.1q standard
	- reduce load of STP by segmenting the network broadcasts
	- frame (vlan tag) is added a header before sending, stripped when received by another trunk's end (unless sent again?)
		- unless it's the native VLAN
	- the native VLAN isn't tagged so other devices in that broadcast domain don't get confused
		- data from a switch to another where both have matching native VLANs will work despite trunk problems b/c no tags.
	- trunks connected have to decide which VLAN is the native VLAN
	- DTP - dynamic trunking protocol - cisco's way of switches auto-trunking via mode dynamic auto and desirable auto
	- 4096 VLANS, 0-4095
		- 0 and 4095 reserved
		- 1002, 1003, 1004, 1005 reserved


+ Private address ranges
	Class A: 10.0.0.0 to 10.255.255.255	a.k.a. 
	Class B: 172.16.0.0 to 172.31.255.255
	Class C: 192.168.0.0 to 192.168.255.255
    loopback: 127.0.0.0 to 127.255.255.255.255 (only for non-network communication, device talking to itself only)
                   can't use this on cisco loopbacks

+ Multicast address ranges
	224.0.0.0 to 239.255.255.255

+ Link Local address range
	169.254.1.0 to 169.254.254.255
	automatic random host name range for assignment if DHCP not used or fails, on the same LAN only

+ Architecture Notes
    - native vlan should be different than all vlans used by devices - trunk to trunk only    
    - trunk ports don't exist on routers, but switch ports connected to other switches and routers will be trunk ports
    - You could have no VLANs and just subnets if all ports are routed ports - all routers and no switches conceptually!
    - STP not needed if every link between switches are routed ports.  Layer 3 switches required. New tech tries to avoid STP

=========================
Cables
-------------------------

+ Multi Mode Fiber
	- LEDs not lasers
	- Multiple modes = multiple angles of light
	- Transceiver on one fiber, receiver on the other
	- Immune to electrical interference
+ Single Mode Fiber
	- Lasers
	- Longer distance
	- smaller diameter
	- actually cheaper now (but on test it's same cost as multimode)
	- Immune to electrical interference
+ Crossover cable
	- Not used for 1Gpbs+ cables
	- pins 1 to 3, 6 to 2
		- other pins are therefore 2 to 6, 3 to 1, 4 to 4, 5 to 5, 7 to 7, 8 to 8
	- Hubs or Switches uses MDI-X connectors, transmitting on pins 3 and 6, receiving on pins 1 and 2
	- Routers, Servers, and PC's have MDI connectors, transmitting on pins 1 and 2, receiving on pins 3 and 6
!	- used for same-to-same connections like pc-to-pc or switch-to-switch

+ RJ-11 - old phone connector at end of phone cables

+PoE - power over ethernet - ethernet cables transfer power to the switch as well as data 
    - FCFS model, first come first serve, unless configured to be a priority port 

=========================
Bit formats of data frames, packets
-------------------------
Ethernet
-------------------------

Preamble--Start Frame Delimiter--MAC Destination--MAC Source--802.1Q Tag (optional)--Ethertype--Payload--FCS Check
 7 bytes	1 byte			        6 byte	        6 byte	    4 byte			    2 byte	    1500 byte	4 byte

1 - Preamble - 7 bytes - Synchronization.  Wake up! Something's coming.
2 - Start Frame Delimiter - 1 byte
3 & 4 - MAC addresses
5 - 802.1Q Tag - VLAN tag
6 - Ethertype - what version of ethernet is this?
7 - Payload - the actual info
8 - FCS Check - error-check

Spanning Tree
-----------------------
2 byte bridge ID (priority number) + 6 byte MAC Address

	+System ID Extension
	2 bytes Bridge ID converted to a VLAN based numbering system
		+[4 bits Priority (Multiple 4096) + 12 bit VLAN ID] + 48 bit MAC Address
		1 0 0 0  0 0 0 0  0 0 0 0  0 0 0 0  0 0 0 1
		1000 = 32768 + 000000000001 = Bridge ID 32769
		0 1 1 1  0 0 0 0  0 0 0 0  0 0 0 0  0 0 0 1
		0111 = 28762 + 000000000001 = Bridge ID 28763
		



=========================
Statuses
--------------------------
+notconnect status gives you all the trouble


"Show IP Int Status"

Line Status			    Protocol Status		    Interface Status	Typical Root Cause
---------------------------------------------------------------------------------------------------
administratively down		down				    disabled		The shutdown command is configured on the interface.
down				        down				    notconnect		No cable;bad cable;wrong cable pinouts;speed mixup;other device is off/shutdown/ error disabled.
up				            down				    notconnect		Not expected on LAN switch physical interfaces.
down				        down (err-disabled)		err-disabled	Port security has disabled the interface.
up				            up				        connected		The interface is working.


Show Interface Status
--------------------------
+This is the ONLY way to see if a speed was autonegotiated!

Port         Name               Status       Vlan       Duplex  Speed Type
Te1/0/1      109c9501-Te1/0/2   connected    trunk        full    10G SFP-10GBase-LR
Te1/0/2      188c9501-Te1/0/1   connected    trunk        full    10G SFP-10GBase-LR
Te1/0/3      046uA6k90-Fa0      connected    501        a-full  a-100 10/100/1000BaseTX SFP
Te1/0/4      c046V2911-Gi0/0    connected    329        a-full a-1000 10/100/1000BaseTX SFP


Show CDP Neighbors
----------------------------
Capability Codes: R - Router, T - Trans Bridge, B - Source Route Bridge
                  S - Switch, H - Host, I - IGMP, r - Repeater, P - Phone
Device ID    Local Intrfce   Holdtme    Capability   Platform    Port ID
R2           Fas 0/0          151            R       C2800       Fas 0/0
Switch       Fas 0/1          151            S       2960        Fas 0/1
Switch       Fas 1/0          151            S       2960        Fas 0/1


Trunkin' - Two ports configured for access or trunking modes resulting in access or trunk operationally:
--------
+=====================+————————————+——————————————+————————————+———————————————————+
| Administrative Mode | Access     | Dynamic Auto | Trunk      | Dynamic Desirable |
+=====================+————————————+——————————————+————————————+———————————————————+
| Access              | access     | access       | do not use | access            |
+—————————————————————+------------+--------------+------------+-------------------+
| Dynamic Auto        | access     | access       | trunk      | trunk             |
+—————————————————————+------------+--------------+------------+-------------------+
| Trunk               | do not use | trunk        | trunk      | trunk             |
+—————————————————————+------------+--------------+------------+-------------------+
| Dynamic Desirable   | access     | trunk        | trunk      | trunk             |
+—————————————————————+------------+--------------+------------+-------------------+
dynamic auto - trying to be access, but if any trunk stuff, it's trunk
dynamic desirable - trying to be trunk, but if vs. straight 'access', it's access
'trunk' vs 'access' - doesn't work, but still shows as up/up!


VLANs:
-------
active	= on
act/lshut = disabled, switch won't forward this vlan's traffic
act/unsup = unsupported


Show Interface Counters / Errors
---------------------
Runts: < 64 byte size packets
Giants: > 1518 byte packets received
Input errors - totals of below counters
	CRC: FCS field did not match CRC check on frame
		- Link partner could have sensed collision


Virtual Sub-Interfaces (Router-on-a-Stick)
----------------------
If physical interface is down/unplugged, all subinterfaces will be down/down
If physical interface is shut, all subinterfaces will be admin-down/down


=========================
Physical Motion
-------------------------
+Collision Domain - # of paths that can potentially collide
    - Hubs - one collision domain
    - Switches - one collision domain per port/wire
    - Routers - one broadcast domain per port, and one collision domain per port

+Broadcast domain - where broadcast traffic reaches
    - one per subnet
    - inside subnets, vlans split broadcast domains also

+Flooding - send out frame to all other ports other than the receiving port, when MAC is unknown, to attempt delivery

+Sending and Receiving basics
1. Sending Frames - done based on MAC address
	a. Destination MAC is broadcast, multicast, or unknown unicast (not listed in the MAC table) --> flood it
	b. Destination MAC is known unicast --> send it, unless same reciever MAC as sender MAC
2. Write to MAC table
	a. get source MAC and note the sender interface (port) (could be from a different device)
	b. if not on MAC table, put MAC and its interface on MAC table
3. Block ports via STP to prevent looping
4. If Router, change source & destination IP address instead of MAC address
5. if trunk port receiving something tagged as the same VLAN ID as the trunk's native vlan, remove the VLAN tag

+Full Duplex - hosts can send and receive data at the same time.  This is always used now. Seperate pins used for transmission and receiving.
+Half Duplex - hosts can only send or receive data at one time. old. Used on wi-fi because of heavy collision issues there.
+CSMA/CD - used on wired networks, protocol to detect and recover from collisions - Carrier Sense Multiple Access with Collision Detection
+CSMA/CA - used on half-duplex (including wireless) networks to avoid collisions - Carrier Sense Multiple Access with Collision Avoidance   
    - Assemble data frame --> is channel free? --> NO, wait for random period --> YES, transmit frame

+There's no such thing as collision on a full duplex connection
    - CSMA/CD is needed only for duplex mismatches now

-------------------------
Counters
-------------------------
Runts: Frames that did not meet the minimum frame size requirement (64 bytes, including the 18-byte destination MAC, source MAC, type, and FCS). Can be caused by collisions.

Giants: Frames that exceed the maximum frame size requirement (1518 bytes, including the 18-byte destination MAC, source MAC, type, and FCS).

Input Errors: A total of many counters, including runts, giants, no buffer, CRC, frame, overrun, and ignored counts.

CRC: Received frames that did not pass the FCS math; can be caused by collisions.

Frame: Received frames that have an illegal format, for example, ending with a partial byte; can be caused by collisions.

Packets Output: Total number of packets (frames) forwarded out the interface.

Output Errors: Total number of packets (frames) that the switch port tried to transmit, but for which some problem occurred.

Collisions: Counter of all collisions that occur when the interface is transmitting a frame.

Late Collisions: The subset of all collisions that happen after the 64th byte of the frame has been transmitted. (In a properly working Ethernet LAN, collisions should occur within the first 64 bytes; late collisions today often point to a duplex mismatch.)


=========================
Physical Interface (Port) Configuration
-------------------------
+Blocking mode - interface(port) cannot forward or receive frames
+Forwarding mode - interface ("port") can forward or recieve frames
+administrative mode - whether it should be used (trunking, access port, disabled, enabled, etc.)
+operational mode - what is being used (trunking, access, dynamic trunking negotiation, etc.)

+100mb port can't talk to a 1000mb port
+autonegotiate works on its own, matches highest speed and best duplex

+routers use access ports, not trunk ports, even though they might be on the other side of a switch's trunk port, and they essentially trunk via sub-interfaces
+virtual server hosts (hypervisor machines) use trunk ports connecting to their virtual server inside that machine

-------------------------
Default configurations
	a. interfaces are enabled by default
	b. interfaces assigned to VLAN 1
	c. autonegotiation between 10/100 and 10/100/1000 interfaces
	d. MAC table writing, flooding, forwarding
	e. STP enabled
	f. SSH servers and receivers
	g. console automatically receives copies of all unsolicited syslog messages on a switch
	h. exec-timeout 5 minutes of inactivity leads to session ending
	i. tries to resolve ip hostnames via dns, which could be accidental and takes a minute


------------------------------------------------------
Default Duplex & Speed Behavior
------------------------------------------------------
+You force one side of a cable to be 100mb & full duplex on that port.  On the other end, you leave it at default.  It's a Gigabit cable.  What happens?
	Other side will detect a forced setting of 100mb and go with that, but it defaults to Half Duplex for any setting of 100mb! Duplex mismatch.


-------------------------
Vlan for switchport
-------------------------
+Easy example
1. enable, then config t
2. (config)# interface fa/01				[enter config menu for this specific interface port]
3. (config-if)# switchport access vlan 1		[port assigned for vlan1 traffic when in access mode, not in trunk mode]
4. (config-if)# switchport mode access			[set port to always be an access port, can't be a trunk if requested to]
Phone also - (config-if)# switchport voice vlan		[Also allow phone use for this port, just in case. This doesn't interfere.]

+"switchport mode dynamic auto" is default
	- another switch needs to have "switchport mode dynamic desirable" for autonegotiation of trunking to occur

(config)# interface fa/02
switchport trunk allowed vlan 10,2,55-60		[allow these vlans for this trunk port]
switchport trunk allowed vlan remove 10,2,55		[remove these vlans for this trunk port]

=========================
>>>Switch Configurations (beginners)
-------------------------
+made to work by default if you just plug in cables and turn it on
! But to manage remotely, you'll need to give it its one possible IP, and that means it needs a default gateway too!
+ip address configured on a switch for that switch is just for reference and management purposes. No effect on data handling
+always have to save new configuration via #copy running-config startup-config, then hit enter, saving the current config to the startup file
+almost everything has to be configured from the (config) section so commands are written assuming that unless a "show" type command
+Switches and their ports don't need an ip address.  The only reason is to assign the entire device an ip so you can login to it remotely
	or it's a layer 3 switch, which does both routing and switching

-------------------------
Clearing config
-------------------------
1. erase startup-config = erase startup-config file
2. delete vlan.dat = delete vlan config
3. reload = reload the server to start with new cleared settings

-------------------------
New Configuration
-------------------------
0. hostname xxyy [switch is now named xxyy]
1. Find the MAC address to a phone or laptop or something connected to a "data drop" ethernet wall connection leading directly to the distribution switch.
2. You'll need to search the distribution switch for the MAC address. Find the port using this MAC address.
3. Find a switch configuration trunk port at a similar location.
4. Configure the port on the distribution switch to instead be a trunk port.
5. Configure your new switch to have a trunk port configuration matching the distribution switch.
6. Connect the new switch's trunked port to the data drop wall connection.
7. Now you can connect whatever you want to the new switch, including that phone or laptop you replaced, if you configure your new switch's ports.

initial commands
-------------------
enable
conf t
hostname Switch01
conf t
line 0 15							[line = console line, 0 15 = rooms ("lines") 0-15]
username john doe enable secret cisco
login local
line vty 0 15
enable secret cisco
interface vlan1						[ip address should be configured in the native vlan interface, so vlan1 interface]
(conf-if)ip address 10.1.10.0 255.255.255.0	[ip address of switch is now 10.1.10.0, don't forget the subnet mask]
no shutdown						[turn on the interface]
ip default-gateway  10.1.1.1			[default gateway or ip won't work beyond the subnet]



-------------------------
SSH Configuration
-------------------------
+ Switches are SSH servers and receivers by default, but they need a key to connect to others

+ show ip ssh = shows ssh server info
+ show ssh = shows ssh client info (clients connected to the switch)

+ Local key method for SSH connection with local user names (as opposed to centralized server-based authentication):
1. config t
2. hostname sw1 						[switch name is now sw1]
3. ip domain-name  example.com 			[switch's domain name is now example.com]
[next command will use sw1.example.com as input for the encrypted key.  The combination of sw1 and example.com]
5. crypto key generate rsa 				[sw1.example.com encrypted via rsa and a key was generated from it]
6. ip ssh version 2					[version 2 is more secure]
7. exit
7. enable
8. config t
9. line vty 0 15
10. transport input ssh	[all vty lines must now use ssh instead of telnet]
11. login local         [enforce local usernames and passwords]


! Accessing SSH via Windows
C:\> ssh -l MyUserName 10.0.0.1
Open
Password: EnterMyPassword
Switch1>                            [you're in, buddy]


-------------------------
Telnet Configuration
-------------------------
1. enable
2. config t
3. line vty 0 15
4. transport input telnet	[all vty lines can use telnet in addition to others if configured]


-------------------------
VLAN Basic Configuration
-------------------------
+ Your switch has to be part of some VLAN, which then requires it to be in some subnet for that VLAN
	- This requires setting the "VLAN interface"
+ Using an unused VLAN assigned to no physical ports means no communication from your switch
+ All vlans are allowed by default.  Specifying vlans on the allowed list restricts them that way.
+ ports are by default DynamicAuto VLAN setting - can be an access port or a trunk port! Hacker could make it a trunk!

1. # configure terminal	[go to "configure" section]
2. (config)# interface vlan 1	[go to vlan 1 interface]
3. (config-if)# ip address 192.168.1.200 255.255.255.0	[set the switch's ip address and subnet mask for vlan 1]
4. (config-if)# no shutdown		[enable the vlan interface]
00:25:07: %LINK-3-UPDOWN: Interface Vlan1, changed state to up
00:25:08: %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan1, changed state to up
5. (config-if)# exit
6. (config)# ip default-gateway 192.168.1.1		[set the default gateway to enable communication out of the subnet]

-------------------------
VLAN Switch Real Configuration
-------------------------
+Real example 
056F3826(config)#default int gi1/0/1			[First be sure to default it before you change anything]
switchport trunk encapsulation dot1q 			[doing this first on 3700 models ensures you can trunk it afterwards]
switchport mode trunk 
description 056c4k01-Te3/4    RL=-3.0 RH=-3.0 TL=-2.2 TH=-2.2 201206201413	[description for that switch]
switchport trunk allowed vlan 602,603,605,612,616,617,629,650,701,702,731,856	[allowlist vlans]
switchport trunk allowed vlan add 4561-4567					[add extra vlans]
switchport nonegotiate
srr-queue bandwidth share 1 70 25 5 [this didn't work we had to remove it]
srr-queue bandwidth shape  4 0 0 0  [this didn't work we had to remove it]
priority-queue out		[this didn't work we had to remove it]
mls qos trust dscp
rmon collection stats 13101 owner monitor
channel-group 1 mode on
ip dhcp snooping trust
(config)# shutdown vlan 11
------------------------------------
! Remote Connectivity Setup Minimum
------------------------------------
interface vlan 701		[701 is our management vlan]
ip address 10.69.420.xxx 255.255.254.0
ip default-gateway 10.69.420.1


-------------------------
Telephone Setup
-------------------------
(config)interface Gi0/1
(config-if)switchport mode access
(config-if)switchport access vlan 70
(config-if)switchport voice vlan 90

-------------------------
MAC Aging
-------------------------
+ MACs age based on Global settings or specific for different vlans which override it

show mac address-table aging-time = show seconds that MACs exist before deletion
clear mac address-table dynamic

+MACs replaced by oldest for newest when full

-------------------------
Memory
-------------------------
CAM - Content Addressable Memory
	> Physical memory
	> Good for table lookups
	- MAC

-------------------------
Random Configurations
-------------------------
int range Gi0/1-15   - works on that entire range at once, shows up as (config-if-range)
history size x - remember x entries in terminal for you to reference and re-input via up/down arrows ("history buffer")
(config) no logging - console - stop the dumb messages from showing up when using serial connection
(config) loging console warnings - limit the dumb logging interruptions to warnings or worse
(config-if) logging synchronous - don't get interrupted by syslogs when you're typing
(config) no ip domain-lookup - don't automatically try to resolve ip hostnames to dns
(config-if) no cdp enable - disable cdp for that interface, so the connected device won't get cdp info
no cdp run-->cdp run - flush the cdp cache on the device by shutting off cdp and turning it back on

=========================
>>>Finding Stuff
-------------------------
# = needs enable mode
> = doesn't need enable mode
_none_ of this requires config mode

Switches
#	show run - show running config
#	show run | include ssh - show only lines with ssh
#	show run | section rip - show entire section of rip config
#	show run | begin rip - show running config beginning where rip is found
>	show mac address-table dynamic address 986D.0AC2.6AFB
>	show mac address-table dynamic interface fastEthernet 0/1 = show MAC of port on this switch
>	show mac address-table dynamic vlan 1 = MACs on this switch for vlan1
#	#show interfaces status - status, duplex, assigned speed, port type
>	show interfaces - details in paragraph form for each interface
	!This is NOT show interfaces status.  "show interfaces" =/= "show interfaces status"
#	show interfaces f0/1 status - show status in one line
>	show interfaces f0/1 - show detailed status including statistics of packet transfer
>	show interfaces f0/1 switchport - detailed information on config of the port, includes trunking status
>	show interfaces vlan 1 - show ip's, subnets, status of vlan 1
!>	show interfaces trunk - shows vlans on trunk, vlans allowed on ports, and native VLAN, blank if no ports trunking
>	show arp
>	show cdp neighbors - show devices connected to the switch, by hostname and port, eg. R2 Gi0/1
>   show cdp interface - show which ports are using cdp
#	show dhcp lease - show dhcp ip's
>	show vlan brief - just vlan, vlan name, status, ports
>	show vlan	- shows unassigned vlans
>	show spanning-tree
>	show spanning-tree vlan 10
    show spanning-tree detail
>	show ip interface brief - shows ip's and interface status as up/down for both "status" (line) and "protocol" (admin)
								and SVI virtual vlan interface ports on a layer 3 switch
#	debug rip/erp/etc
		show real-time updates of this kind of information
#	undebug all - stop all debug notifications
	[Vlan stuff]
		show interfaces vlan 1 - show ip's, subnets, status of vlan 1 "interface"
		show interfaces trunk
		show vlan brief
		show vtp status
        show vtp password
>	show etherchannel summary
#	show port-security interface fa/02
    show port-security address
    show mac address-table secure - same as port-security address, almost exactly. Secure MAC list
    show errdisable recovery
    show privilege - show your access level
>   show version
    show history - show list of prior entries

Routers only
>	show ip ospf 	- summary of ospf overall config
>	show ip ospf interfaces 	- detailed interface port description for all ospf interfaces
>	show ip ospf interface brief 	- same but only ospf
>	show ip ospf interface fastethernet 0/0 - show ospf for Fa0/0 port on this router
>	show ip route 	- L 10.237.246.152/29 [110/112] via 10.0.211.154, Vlan974 - protocol, ip+subnet, admin distance, route, VLAN
#	show running-config | include ip route 	- show ip route configurations you've entered, which may not have resulted on the routing table
>	show ip protocols - detailed protocol settings, Router ID, gateways, subnet and more
}>	show protocols 	- not show ip protocols, show ports line statuses, protocol status, and any ip's configured+subnet mask for each switchport
		Vlan27 is administratively down, line protocol is down, Internet address is 10.0.208.72/27
		TenGigabitEthernet1/0/1 is up, line protocol is up
#	write memory - save running config on older devices this way because on Packet Tracer it's older devices
>	show ip [routing protocol] database - show ip tables for that protocol, even ones that didn't end in routing table
>	show ip ospf neighbor - checking adjacencies
>	show ip eigrp neighbor
#	clear ip arp - manually remove an arp entry attributed to a specific ip address
>	show ipv6 route
>	show ipv6 neighbors
>	show ipv6 interface brief (wtf!!)
>	show ipv6 interface Gi0/1
>	show ip dhcp pool - shows dhcp settings and summary
>	show ip dhcp binding - lists dhcp clients
#	show standby - show hsrp info for the router
Routers can't do this
	show interface status (wtf!!)
	show vlan
Dumb commands you may need to memorize
	disable								exit enable mode
=========================
Enable mode (privileged mode)
-------------------------
clearing stuff
erasing stuff


=========================
Conflict-Prone & Troubleshooting
-------------------------
+Ping - 1st thing you do
- If any ping works, you know layers 1 and 2 are ok
- ping from a different source address to test subnets, etc.
        ping 10.1.1.1 source 10.2.2.2
- for any ping failures, check on routers inside each subnet on the path to see if there's a default gateway issue for the host
- if a problem between routers on the same subnet, it might be a wireless problem
	- do a ping with 5000 pings instead of 5.  If 1 drops the wireless may be spotty and wrong

+Traceroute - 2nd thing you do
- finds which hop is broken

+show ip route - check out the routing tables - may not be getting the necessary routes

+Autonegotiation fails:
Speed: Sense the speed (without using autonegotiation), but if that fails use slowest speed, often 10 Mbps).
Duplex: If speed = 10 or 100, use half duplex; otherwise, use full duplex.
	> Usually the ports can sense the speed and configure to match the maximum speed
		> Problems mentioned are 100 Mbps connections, which end up as 100 Half (default) vs 100 Full duplex (manual)
			so someone probably manually configured one and then the other side is on auto-negotiation

+duplex mismatch means spotty and bad connection
	> Hard to identify because status on both ends will be up/up!
	> makes late collision counters
	> full duplex switch will constantly send data to half duplex.  Half-duplex will interrupt its data creation whenever data is received.
		Then the half-duplex will wait a set amount of time and try to send something again, which will of course be interrupted and sent half-baked
		The full duplex side will show a lot of FCS error check issues noticed from the half-duplex side (this guy's sending a lot of garbage....)
		The half duplex side will be showing constant collisions ('late collisions')

+speed mismatch causes down/down status

+Hubs, because they need half duplex to avoid collision and can't forward autonegotiation signals, limiting speed (10mbps)

+Late collisions also happen when cables are too long, the most common cause actually.

+Routing Table not showing your route?
	- next hop address could be wrong and unknowable to the router -- only knows its neighbors!
	

+optical fiber bent too much ("macrobending")

+OSPF Troubleshooting
	Check adjacencies, via show ip ospf neighbors
	Check routing table
	Manual summarization on the Area Border Routers? flooding of routes otherwise
	Network x.x.x.x added to actually route this subnet?
	auto-cost reference-bandwidth equal on each router? otherwise route costs will be asymmetric

+Network Broadcast Loop
- Floods of broadcast traffic overcrowding
- Max CPU
- MAC address instability

+Native VLAN has to be configured for every single port, if not the default
+Native VLAN mismatch still transfers between switches, in reality it's stopped by STP, theoretically the data would be transferrable

-------------------------
>>>Troubleshooting the CCNA Way
-------------------------

+Router# show ip int brief			shows quick status of up or down, or 'administratively down'. Better on routers because the routers should have some IPs setup
	administratively down?		    interface port probably needs administrative config.  You forgot to type 'no shutdown' to start it's settings.
	down/down?					    Layer 1 issue. check both sides are powered on and cabled correctly.
	up/down?					    Layer 2 issue. mismatched duplex, speed, etc. Check the config on both devices are the same or amicable.
							        You could have configured the vlan on the router/vlan-interface but not configured vlans on the switch
    up/up?                          Layer 3 issue or trunk/access mismatch.
+If no ping and up/up, then the host may not know the correct default gateway to get out of its subnet
+rarely happens, but trunk vs access ports will only work if the access port's vlan is the native vlan on trunk port. Because access ports don't tag traffic with vlans!
                    - still won't receive any non-native vlan traffic from the trunk port, because access ports drop all vlan tagged traffic received 


+Switch# show ip int brief			show the basics
+Switch# show int status			show speed configured, on switch's ports, duplex, etc
+show int Gi0/1					    show statistics for a problem port					

-------------------------
>>>VLAN Setup
-------------------------
vlan 11											[creates vlan 11 and activates it, ready for assignment to access ports, unnecessary for trunk ports]
(config-vlan)name Maxs_Vlan_is_vlan_11			[name vlan 11 "Maxs_Vlan_is_vlan_11"]

interface Gi1/0/1
 switchport access vlan 11                      [creates vlan 11 if not already created, and assigns this port to vlan 11. All other vlan traffic is rejected.]
 switchport mode access
	(or switchport mode dynamic auto)
	(or switchport mode dynamic desirable)
	(or switchport mode trunk)
 switchport access vlan 20						[vlan 20 on this port is assigned, it'll only carry vlan 20 now]
!                                               [Switch-->Router port should probably be a trunk port, & Router-->Switch ports probbably want vlans assigned too! This is via sub-interfaces]
interface Gi1/0/2
!switchport trunk allowed vlan add 11			[allow vlan 11 on this port, if it's in trunk mode]
                                                [unlike access port modes, vlans are not automatically created for trunks, because trunks accept all tags, they just don't forward all] 
 switchport trunk allowed vlan remove 30        [remove vlan 30 from allowed list]
 switchport trunk allowed vlan 11               [only allow vlan 11 now]
 switchport trunk allowed vlan all              [allow all vlans now]
 switchport trunk allowed vlan except 30        [allow all but vlan 30]
 switchport trunk allowed vlan none             [allow no vlans, only native untagged]
!switchport trunk native vlan 2					[change native vlan to 2]
 switchport nonegotiate							[set this cmd to hard-set trunking and turn off DTP]

###Probably Need to Configure the Router too via Sub-interfaces
Router1(Config)interface gigabitethernet 0/0.10				    [assigns a name for the sub-interface, usually named after the desired VLAN]
Router1(Config-if)encapsulation dot1q 10						[enables VLAN tag identification and defines the VLAN ID associated with the subinterface for VLAN 10]
Router1(Config-if)ip address 10.1.10.1 255.255.255.0

Router1(Config)interface gigabitethernet 0/0.20
Router1(Config-if)encapsulation dot1q 20						[this command also allows trunking for this subinterface, as well as naming it]
Router1(Config-if)ip address 10.1.20.1 255.255.255.0

the sub-interface names don't actually have to match the vlan id, it's just helpful


VOIP Setup - phones
interface gi1/0/1
switchport access vlan 11
switchport mode access
switchport voice vlan 31
(cdp is enabled by default, and required, you can re-enable with: “cdp enable”)

show interfaces switchport
  --> Will show the voice VLAN as well as the data vlan (access vlan)
  --> Will still show as a static access port, not a trunk


-------------------------
VLAN Troubleshooting
-------------------------
1. Confirm all vlans are defined and active
	> "show vlan" shows active vlans on the switch on access ports only, any vlans only on trunk ports won't show
2. Compare allowed vlan lists on both ends of each trunk
    > "show vlan brief" shows a shorter version of just the access port vlans
	> "show interfaces trunk" is good to show what's ok
		> vlans there were not banned from the allowed vlan list on the trunk
        > if some trunks aren't showing, those lines could be disconnected
	> allowed vlans should match
3. Check trunk settings, ensure both sides would trunk (if that's the goal)
	> "switchport mode desirable auto" is needed if connecting another switch using "switchport mode dynamic auto"
	> one could be using direct trunk mode and disabled dynamic trunking via nonegotiate, so losing packets from a DTP switch
4. Compare native vlan settings on both ends of the trunk to ensure the native vlan is the same
	> otherwise its received on whichever vlan is considered native there
    > pc1 -->vlan 10-->SW1 native vlan 10 --> drops ALL vlan tags ---> SW2 native vlan 20 -->pc10 can only receive if on vlan 20!
        > this is why the native vlan should be different than anything else used by ports - trunk to trunk only to reduce issues

+"show interfaces trunk" troubleshooting in detail
	> VLANs Allowed list (1st) : VLANs 1–4094, minus those removed by the switchport trunk allowed command
	> VLANs Allowed and Active (2nd) : The first list, minus VLANs not defined to the local switch, minus vlans in shutdown mode
        - you could have some inactive vlans assigned on the switchports, fucking them up but it still shows up/up!
	> VLANs in Spanning Tree : The second list, minus vlans in an STP blocking state for that interface, minus VTP pruned vlans

+if using SVIs, did you enable ip routing on the layer 3 switch?


-------------------------
VLAN Disable/Delete
-------------------------
shutdown vlan 11
	or
(conf)#vlan 11
(conf-vlan)#shutdown

no vlan 55 - deletes the vlan

int gi1/0/2
switchport trunk allowed vlan 11,21,31-100		[only allow vlans 11,21,31 through 100]
switchport mode trunk


-------------------------
VTP Setup
-------------------------
(config)vtp domain <name>
(config)vtp mode <server, client, transparent>


-------------------------
>>>Spanning Tree Setup
-------------------------
show spanning-tree
show spanning-tree detail
spanning-tree mode rapid-pvst							[rapid-pvst spanning tree mode enabled]
spanning-tree vlan 10 root primary						[change STP bridge ID for this switch for this VLAN as 28672, which is 4096 less than default value]
spanning-tree vlan 20 root secondary					[change STP bridge ID for this switch for this VLAN as 24576, which is 4096 less than default primary value 28672]
spanning-tree vlan 20 priorty 28672						[change to lower priority so it will be root or maybe the secondary, backup root switch for this vlan]
(config-if)spanning-tree vlan 1 cost 2							[change STP cost of port manually]

(config-if)spanning-tree portfast trunk					[disable spanning tree even if the port is trunking]
(config-if)spanning-tree bpduguard enable				[block bpdu's on this end-user port connected to a pc]

-------------------------
>>>Etherchannel Setup
-------------------------
Switch 1
(config) default interface te1/2									[set ports to default settings]
(config) default interface te1/3
(config) default interface te1/4
(config) default interface te1/5
(config) interface range te1/2 - 5									[configure all ports at once]
!(config-if-range) channel-group 1 mode [active/on/desirable]		[create the port channel group and assign these ports to it]
																	[active = LACP, on = Static, desirable = PAgP]

	__Switch 1 Trunk or Access Config__
(config-if-range) switchport mode trunk								[trunk or access mode]
	OR switchport access vlan 20									[if access mode instead, vlan 20 on this port is assigned, it can only carry one]
(config-if-range) switchport trunk allowed vlan add 10				[allow a desired vlan 10 on this port, among others, if it's in trunk mode]
(config-if-range) switchport trunk native vlan 2					[change native vlan to whatever's needed]

(config) interface port-channel 1									[now configure the port channel itself because it's a new port]
(config-if) switchport mode trunk									[channel interface mode must match port interface mode]
(config-if) switchport trunk allowed vlan add 10				[allow a desired vlan 10 on this port, among others, if it's in trunk mode]
(config-if) switchport trunk native vlan 2					[change native vlan to whatever's needed]

__Switch 2__just matches__Switch 1 basically__
(config) default int range te1/2 - 5
(config) interface range te1/2 - 5
(config-if-range) channel-group 1 mode passive						[side 2 can be passive]
(config-if-range) switchport mode trunk
(config-if-range) switchport trunk allowed vlan add 10
(config-if-range) switchport trunk native vlan 2

(config) interface port-channel 1
(config-if) switchport mode trunk
(config-if) switchport trunk allowed vlan add 10
(config-if) switchport trunk native vlan 2

Add a port to a Group
-----------------------
interface te1/1
(config-if) channel-group 4 mode [active/on/desirable]				[adds port to group 4]


Layer 3 Switch etherchannel config
------------------------
(config) interface range te1/2 - 5
(config-if-range) no switchport										[if layer 3 switch, make it a layer 3 port]
(config-if) channel-group 3 mode active
(config-if) switchport mode trunk

(config) interface port-channel 3
(config-if) ip address 10.10.99.66 255.255.255.0
(config-if) no shutdown

###Verifying etherchannel
show etherchannel

=========================
>>>Router Setup
-------------------------
enable
config t
hostname	xxyy
###Note the ip address would be setup on a specific port on the router, because this is what routers do!
###router connects subnets, so each port MUST connect to a different subnet. Every port enabled needs an ip and an exclusive subnet

###Connected Routes (must be up/up)
[connected routes are auto created when the ip port is opened.  It's just sensing what's on the other side.]
interface Gi0/0
ip address 10.1.1.1 255.255.255.0                       
no shut

####Static route - routes we manually add in
ip route 10.1.1.0 255.255.255.0 192.168.1.3



interface fa0/1
(config-if)ip address 10.10.1.1 255.255.255.0			[ip address given to port fa0/1 on this router. don't forget the subnet]
no shut
interface fa0/2
ip address 10.10.2.1 255.255.255.0
no shut
				10.10.1.1/24<----Router 1 fa0/2 10.10.2.1/24---->Switch1  vlan1 fa0/1 10.1.1.1<---- Router 2 fa0/1 10.30.10.1/24
enable DNS
	(conf) - 	ip domain-lookup 				[unnecessary because this is enabled by default]
			ip name-server	xxxx.xxxx.xxxx.xxxx		[treats that server as the DNS server]
ip route 10.0.1.0 255.255.255.0 10.0.0.1				[looking for 10.0.1.x? from here go to the next hop at 10.0.0.1, then figure it out]
		n.n.n.0 with 255.255.255.0, has to match subnet mask optionality, not one specific device in the beginning
ip route 0.0.0.0 0.0.0.0 203.0.113.2					[assign a gateway of last resort, catch-all route for any unrecognized traffic, to ISP]
    ! This would only be if the gateway to the ISP is on this exact subnet.  Otherwise, it's the next hop as normal that would point towards this subnet.
	need to do this for the default route:
(config-router)default-information originate				[ensures the route is advertised to neighbors regardless of whether it's recognized by OSPF or not, OSPF only]
									[this route will show on the routing table as O*E2 - OSPF externally learned type 2]

interface loopback 0
(config-if)ip address 192.168.1.1 255.255.255.255			[loopback address for loopback interface 0 is now 192.168.1.1]

(config)router rip/ospf/is-is						    [enter router config for rip or ospf or whatever]
(config-router)passive-interface loop0					[loopback0 is set as a passive logical interface]
(config-router)passive-interface f2/0					[f2/0 is set as a passive physical interface, not trading routes]

(config)router ospf
(config-router)passive-interface default				[alternatively you can set interfaces as passive by default]
(config-router)no passive-interface fa3/0				[disable default passive interface setting on this port

ip route 10.0.1.0 255.255.255.0 10.0.0.1 permanent			[force this to be and stay on the routing table DO NOT DO THIS]

###Simple Router Setup w/ Router and a Switch (not practical)
SW1# interface Fa0/1									[the switch has to connect to the router correctly]
SW1# switchport access vlan 10							[each port on a router will be routing one entire subnet, therefore this switchport will be using that subnet's vlan]
SW1# switchport mode access								[explicitly make it access mode, just in case]
SW1# no shutdown

R1# interface Gi0/1
R1# ip address 10.1.10.1 255.255.255.0					[note that no vlan "encapsulation" is needed, routers only care about subnets in this simple setup]
R1# no shutdown
R1# interface Gi0/2
R1# ip address 10.1.20.1 255.255.255.0
R1# no shutdown
R1(config)# ip route 0.0.0.0 0.0.0.0 203.0.113.2				[create default route to external internet provider]

###Routing with VLANs via Sub-interfaces
(Config)interface gigabitethernet 0/0.10				[assigns a name for the sub-interface, usually named after the desired VLAN]
(Config-if)encapsulation dot1q 10						[enables VLAN tag identification and defines the VLAN ID associated with the subinterface for VLAN 10]
(Config-if)ip address 10.1.10.1 255.255.255.0

(Config)interface gigabitethernet 0/0.20
(Config-if)encapsulation dot1q 20						[this command also allows trunking for this subinterface, as well as naming it]
(Config-if)ip address 10.1.20.1 255.255.255.0

the sub-interface names don't actually have to match the vlan id, it's just helpful


###If routing with the native VLAN
[The native VLAN can be configured on a subinterface, or on the physical interface, or ignored]
See ROAS section below


###Router-on-a-Stick setup (ROAS)
interface Gi0/0.10							[creating a sub-interface for routing this specific VLAN on the Gi0/0 physical interface]
encapsulation dot1q 10						[enable trunking for this router sub-interface and this sub-interface uses vlan 10]
ip address 10.10.10.1 255.255.255.0			[this sub-interface is ip 10.10.10.1 so it's the default gateway, in the subnet 10.10.10.x, which is for vlan 10]

interface Gi0/0.20							[creating the second virtual sub-interface to handle traffic from a different VLAN, same Gi0/0 physical port]
encapsulation dot1q 20						[trunking and vlan 20]
ip address 10.10.20.1 255.255.255.0			[second sub-interface is the default gateway for the 10.10.20.x subnet which is for vlan 20]

+if traffic comes from the native Vlan per the switch, then you have two options:
	- configure the main interface, the physical port, which is interface Gi0/0 here, as the default gateway for the native vlan's subnet, no encapsulation
		interface Gi0/0						[configure the physical port, not the sub-interfaces]
		ip address 10.10.1.1 255.255.255.0	[the router's port is now the default gateway for the native vlan if it's using subnet 10.10.1.x]
	- use a subinterface with a slightly different command for encapsulation
		interface Gi0/0.01					[create a sub-interface to route the native vlan, if its vlan id is 1]
		encapsulation dot1q 1 native		[oh snap we need to tell the router what to do with untagged traffic, here its vlan id is 1]
		ip address 10.10.1.1 255.255.255.0

!Switch1(conf-if)#switchport trunk encapsulation dot1q          [must trunk the switch's port on the other end of the router to complete the connection!]
!Switch1(conf-if)#switchport mode trunk

###Verifying Router-on-a-Stick (ROAS)
Router# show ip route
	- look for "C" connected routes
Router# show vlan
	- routing may still fail because of problems on the attached switch, both could say it's fine but not matching configuration!
	- encapsulation dot1q <vlan id> for each subinterface?		[Is each non-native VLAN configured on the router?]
Switch# show interfaces trunk									[same VLANs exist on the trunk on the neighboring switch?]
		- are they in the allowed list, not VTP pruned, and not STP blocked?
Router# show interface Gi0/1									[each router ROAS subinterface have an IP address/mask configured per the planned configuration?]
	- native VLAN, is it configured correctly on physical interface?
		- or logical subinterface
	- Are the router physical or ROAS subinterfaces enabled with a no shutdown command?
	- Switch#show int trunk			[same native VLAN configured on the neighboring switch’s trunk]


###Switch Virtual Interface (SVI) - Layer 3 Switch Only
####like router-on-a-stick sub-interfaces but in the switch instead
####This is different than a vlan, it's a virtual routing interface port to use for a vlan
(config)ip routing								[enable routing on the Layer 3 switch]

interface vlan 10								[create and enter the virtual interface for vlan 10]
ip address 10.1.10.1 255.255.255.0				[Give it an ip and subnet]
no shutdown										[enable the interface]

interface vlan 20
ip address 10.1.20.1 255.255.255.0
no shutdown

interface vlan 30
ip address 10.1.30.1 255.255.255.0
no shutdown

###Verifying SVI
show ip interface brief
Interface			   IP Address	   OK? Method Status				Protocol
Fa0/1				   unassigned      YES manual administratively down down
Gi0/1				   unassigned      YES manual up					up
Te0/1				   unassigned      YES manual up					up
Vlan1                  unassigned      YES manual administratively down down		[This is NOT a vlan config, it's a virtual port for routing this vlan traffic]
Vlan10                 10.1.10.1       YES manual up                    down		[Fa0/1 could've been shutdown if it's the last physical access interface on the switch for this vlan]
Vlan20                 10.1.20.1       YES manual up                    down		[vlan 20 could've been deleted on this switch]
Vlan30                 10.1.30.1       YES manual up                    down		[vlan 30 could've been shutdown on this switch]
		Subinterfaces can be shut down individually with “shut” and “no shut”
		If physical interface is down/unplugged, all subinterfaces will be down/down
		If physical interface is shut, all subinterfaces will be admin-down/down

###Layer 3 Switch enabled Routing Ports
interface Fa0/1
no switchport

###Layer 3 Etherchannel using routed ports on a Layer 3 Switch
SW1# interface Fa0/1									[configure the physical interface ports for Switch 1]
 channel-group 1 mode on								[add them to the etherchannel group]
 no switchport											[make it a routed port not a regular switchport]
SW1# interface Fa0/2
 channel-group 1 mode on								[add this other port to the same group]
 no switchport

SW1# interface port-channel 1							[create the etherchannel's interface and configure the etherchannel settings]
 no switchport											[make it for routing, not switching]
 ip address 10.1.10.1 255.255.255.0						[give it an ip, subnet]

SW2# interface Fa0/1									[don't forget to configure the exact same on the other side for Switch 2]
 channel-group 1 mode on
 no switchport
SW2# interface Fa0/2
 channel-group 1 mode on
 no switchport

SW2# interface port-channel 1
 no switchport
 ip address 10.1.10.1 255.255.255.0


###Verifying Etherchannel Layer 3
show interfaces port-channel 12
show interfaces status
show ip route
	- check for C - connected route of the etherchannel's interface, "port-channel"
show etherchannel summary

=========================
Other Router Commands
-------------------------
no ip classless									enable class-based public+private ip ranges and it'll attempt to auto-route with that
#traceroute 10.1.0.1 [on cisco]
	ctrl+shift+6 to abort
tracert 10.1.0.1[on Windows PC DOS]					    [trace network flow to 10.1.0.1 to ensure user connectivity]
#ping 10.1.0.1
#ping	(enters the menu) 							    [good for specifying starting ping locations other than where you are]
	extended commands: y
ping 10.0.0.1 source 10.0.0.10				            [ping from another source]
ping 10.0.0.1 source 10.0.0.10 4489                     [ping from a different port]     
	ctrl+shift+6 to abort
ctrl+z										            [exit all the way back to main exec/privileged mode, out of int/line+config mode]
=========================
>>>OSPF
-------------------------
config terminal
(config)router ospf 1						            [ospf 1 is the "process id" of 1. Another ospf process id of 2 would be an entirely separate instance]
(config-router)network 10.0.0.0 0.255.255.255 area 0	[configure this router to be in network 10.x.x.x area 0]
!								                        [Unlike static routing, you ONLY NEED to network the device's next-hop ip's, NOT ALL IPs]

or, if you've already started the ospf db via router ospf 1
(config)interface Gi0/0
(config-if)ip ospf 1 area 0					            [interface-based way to do it]

(config)router ospf 1						            [On the ABR (Area Border Router) we need to summarize for both areas connected]
(config-router)network 10.1.0.0 0.0.255.255 area 0		[work routes at this device for these subnets for these areas]
(config-router)network 10.0.0.0 0.0.255.255 area 1
(config-router)area 0 range 10.1.0.0 255.255.0.0		[if any other area needs Area 0, it will use this summary route 10.1.0.0 for any 10.1.x.x]
(config-router)area 1 range 10.0.0.0 255.255.0.0		[the summarization here uses a subnet mask format while the network cmd above uses wildcard mask]
(config)clear ip ospf process                           [refresh the ospf process to bring in the overwriting changes]
show ip protocols                                       [this is the only way to confirm what routing was applied to ospf]

(config)router ospf 1
(config-router)network 10.1.2.3 0.0.0.0 area 1			[use ospf for this specific ip]

(config-router)default-information originate			[ensures the route is advertised to neighbors regardless of whether it's recognized by OSPF or not]

show ip ospf neighbor						            [verify adjacencies formed]

(config)router ospf 1
(config-router)auto-cost reference-bandwidth 100000		[set cost reference from default's 100Mb to 100000Mb/s, so gigabit ethernet is faster than 10Mbs ports]

(config-if)# ip ospf cost 10					        [set cost for this interface manually]
(config-if)# bandwidth <Kbps>					        [set bandwidth for this interface manually (no physical effect)]

(config)interface GigabitEthernet0/0				    [ospf priority can only be done on an interface port]
(config-if)ip ospf priority 100					        [set as the Designated router by giving this router a higher priority]
#clear ip ospf process						            [refresh ospf processes, new priority will register once shared into all ospf DB's]

(config)no router ospf 1					            [remove the current router, all configs for this router ID]
#clear ip ospf process						            [refresh ospf processes, remove the current router ID, a new one will be auto-chosen]

(config-router)shutdown						            [shuts off ospf for this router/device without removing the config] 

------------------
Verifying OSPF
------------------
>show ip ospf neighbor						[verify adjacencies formed, any dash would be possible mismatch via point-to-point connection]

>show ip ospf database						[shows the LSAs on this router, Link State Advertisements]

>show ip ospf int brief						[check areas, two connected links must have the same area]

>show ip ospf interface fastethernet 0/0			[shows details for this port, check hello timer, check the area]

>show ip int fa0/0						[only way to check MTUs layer 3 config - show int fa0/0 would be layer 2 MTU config]

>show ip ospf							[list of details, check router ID (1.2.3.4), can't be same as others, Proces ID can differ]

>show ip ospf int						[go through all interfaces configs setup with ospf]

>show ip route							[verify routes from OSPF are accepted in the routing table, such as broadcast vs point-to-point]

>show ip ospf neighbor
Neighbor ID     Pri   State           Dead Time   Address         Interface
10.234.255.11     1   FULL/DR         00:00:37    10.234.246.130  Vlan527
10.234.128.46     0   FULL/DROTHER    00:00:39    10.234.128.46   Vlan817
10.234.120.201    0   FULL/DROTHER    00:00:32    10.234.120.201  Vlan816
10.1.224.158      1   FULL/DR         00:00:03    10.0.211.154    Vlan974
10.1.224.157      1   FULL/DR         00:00:03    10.0.211.146    Vlan972

State:
FULL/-									[ the - means point-to-point connection]							
FULL/DR									[this is a designated router]
FULL/BDR								[this is a backup designated router]
FULL/DROTHER								[this is neither a DR or BR router]

>show ip ospf database
            OSPF Router with ID (10.0.209.61) (Process ID 2014)

                Router Link States (Area 31)

Link ID         ADV Router      Age         Seq#       Checksum Link count
10.0.208.19     10.0.208.19     1125        0x800048DB 0x00D002 1
10.0.209.35     10.0.209.35     1145        0x8000698F 0x00B3B5 2
10.0.209.36     10.0.209.36     1559        0x8000354F 0x0099D5 3
10.0.209.37     10.0.209.37     1479        0x8000118A 0x00EECF 2
10.0.209.38     10.0.209.38     1032        0x80007844 0x007398 3
10.0.209.39     10.0.209.39     25          0x80001AF2 0x002B1A 2
10.0.209.40     10.0.209.40     1698        0x8000277D 0x0003A6 2	


>show ip protocols
Routing Protocol is "ospf 2014"
  Outgoing update filter list for all interfaces is not set
  Incoming update filter list for all interfaces is not set
  Router ID 10.0.209.61
  It is an autonomous system boundary router
 Redistributing External Routes from,
    static, includes subnets in redistribution
    bgp 65150, includes subnets in redistribution
  Number of areas in this router is 1. 0 normal 0 stub 1 nssa
  Maximum path: 4
  Routing for Networks:
    10.0.208.0 0.0.3.255 area 31
    10.231.112.0 0.0.7.255 area 31
    10.231.120.0 0.0.7.255 area 31
  Passive Interface(s):
    Vlan959
  Routing Information Sources:
    Gateway         Distance      Last Update
    10.234.255.11        110      1y46w
    10.237.255.5         110      23w1d


Three Basic Steps for OSPF
- Form Neighbor Relationships
- Exchange/Flood LSAs and get the same LSDB on all OSPF routers in area
- Run SPF and add routes to routing table

Verify Neighbor Relationships
show ip ospf neighbor

Verify LSAs are in the LSDB
show ip ospf database

Verify Routes are in the Routing Table
show ip route


+Timer differences and area differences can't even form 2 way connections
+MTU difference would be 2-way but trying to make full connection, constantly changing status in "show ip ospf neighbor"
+Router ID (11.22.33.44) can't be the same
+Broadcast on one link port and point-to-point on the other end causes full neighbor but no routes to show

=========================
>>>EIGRP
-------------------------
config terminal
(config) router eigrp 100							[100 is the Autonomous System number, which links it to networks of the same #]
(config-router) no auto-summary
(config-router) network 10.0.0.0 0.255.255.255


=========================
>>>RIP
-------------------------
config terminal
(config)router rip
(config-router)version 2
(config-router)network 10.0.0.0						[This is actually the subnet.  That's it, that's all you need.]
(config-router)no auto-summary						

(config)router rip
(config-router)network 206.0.113.0					[add another network/subnet to automatically figure out]
									                [only need this on the routers directly connected to this subnet]

config terminal
(config)router rip								
(config-router)network 10.0.0.0						[version 1 is done automatically if we don't enter version 2]
(config-router)no auto-summary


-------------------------
RIPv1 Broadcast info
-------------------------
10.0.3.1 connected to 10.0.3.2 connected to 10.1.3.1 which has ports 10.1.1.1, 10.1.2.1, 10.1.3.1 to those subnets

10.0.3.1---10.0.3.2---10.1.3.1
10.0.0.1			10.1.1.1
10.0.1.1			10.1.2.1
10.0.2.1

Each other port on the same device would be one hop
Every port is one hop other than itself
----------

RIP: sending  v1 update to 255.255.255.255 via FastEthernet1/1 (10.0.3.1)
RIP: build update entries
      network 10.0.0.0 metric 1
      network 10.0.1.0 metric 1
      network 10.0.2.0 metric 1
      network 10.1.0.0 metric 2

RIP: received v1 update from 10.0.3.2 on FastEthernet1/1
      10.1.1.0 in 2 hops
      10.1.2.0 in 2 hops
      10.1.3.0 in 1 hops

-------------------------
RIPv2 Multicast info
-------------------------
10.0.3.1 connected to 10.0.3.2 connected to 10.1.3.1 which has ports 10.1.1.1, 10.1.2.1, 10.1.3.1 to those subnets

10.0.3.1---10.0.3.2---10.1.3.1
10.0.0.1			10.1.1.1
10.0.1.1			10.1.2.1
10.0.2.1
----------

RIP: sending  v2 update to 224.0.0.9 via FastEthernet1/1 (10.0.3.1)
RIP: build update entries
      10.0.0.0/24 via 0.0.0.0, metric 1, tag 0
      10.0.1.0/24 via 0.0.0.0, metric 1, tag 0
      10.0.2.0/24 via 0.0.0.0, metric 1, tag 0
      10.1.0.0/24 via 0.0.0.0, metric 2, tag 0

RIP: received v2 update from 10.0.3.2 on FastEthernet1/1
      10.1.1.0/24 via 0.0.0.0 in 2 hops
      10.1.2.0/24 via 0.0.0.0 in 2 hops
      10.1.3.0/24 via 0.0.0.0 in 1 hops

show ip route
R       10.1.1.0/24 [120/2] via 10.0.0.2, 00:00:10, FastEthernet0/0
                    [120/2] via 10.0.3.2, 00:00:23, FastEthernet1/1
! This means that equal distance was measured for the same route to 10.1.1.0/24, so packets will be load balanced among both paths


=========================
>>>IPv6 Setup
-------------------------
ipv6 unicast-routing									[enable ipv6 for this entire router]

(config-if)ipv6 address autoconfig					    [make ipv6 use SLAAC - stateless address autoconfiguration] <--doesn't work on packet tracer
(config-if)ipv6 address dhcp							[make ipv6 use DHCP instead]

(config-if)ipv6 address FD00:A15D:CAFE:4::4/64			[port addressed to "4" on this ipv6 subnet]

(config-if)ipv6 address 2001:db8:1111:1::/64 eui-64		[port will use EUI formula for 2nd half of this address]
(config-if)ipv6 address FE80:db8:1111:1::1 link-local	[must say 'link-local' instead of /128 to create a link local address!]
														[note: this also replaces the existing link local and is only way of doing so]
(config-if)ipv6 rip AISD enable							[enabled RIP protocol for this interface for ipv6 addresses]

ipv6 route 2001:db8:1111:2::/64 2001:db8:1111:9::3		[add a static route]
ipv6 route 2001:db8:1111:2::/64 gi0/0 2001:db8:1111:9::3		[add a static route with the exit interface as well as the next hop address]

! ping ipv6 FD00:A15D:CAFE:8::4							[ping via ipv6]

###Verifying IPv6
show ipv6 route
show ipv6 interface Gi0/1
	shows its own multicast group for NDP
show ipv6 neighbors
show ipv6 protocols
	is ipv6 even on?
show run | incl ipv6 route
	static routes made by you?


=========================
>>>Wireless Setup >>>Wi-fi
-------------------------

Switch Configuration
----------------------
Switch(config)#vlan 10									                [create management vlan on the switch for managing the APs]
Switch(config-vlan)#name Management
Switch(config)#interface vlan 10						                [create a Switched Virtual Interface for routing the vlan traffic]
Switch(config-if)#ip address 192.168.10.1 255.255.255.0

Switch(config)#ip dhcp excluded-address 192.168.10.1 192.168.10.100		[create DHCP range of 101-254 in the subnet for assigning IPs to APs]
Switch(config)#ip dhcp pool Management									[create a DHCP pool 'Management']
Switch(dhcp-config)# network 192.168.10.0 255.255.255.0					[dhcp pool uses this subnet]
Switch(dhcp-config)# default-router 192.168.10.1						[dhcp default gateway is the Management SVI]
Switch(dhcp-config)# option 43 ip 192.168.10.11							[wireless controller is .10.11, option 43 shows APs this via dhcp]

Switch(config)#vlan 22													[create a vlan for the corporate wifi]
Switch(config-vlan)#name Corporate
Switch(config)#interface vlan 22										[create a Switched Virtual Interface for it]
Switch(config-if)#ip address 192.168.22.1 255.255.255.0

Switch(config)#vlan 23													[create a vlan for the guest wifi]
Switch(config-vlan)#name Guest
Switch(config)#interface vlan 23										[create a Switched Virtual Interface for it]
Switch(config-if)#ip address 192.168.23.1 255.255.255.0

Switch(config)#interface range GigabitEthernet1/0/5						[configure the wired ports from switch to Wireless Controller]
Switch(config-if)#switchport mode access								[since using a Wireless Controller, trunk mode on connection from switch]
Switch(config-if)#switchport trunk allowed vlan 10,22,23				[allow vlans on the trunk]
Switch(config-if)#spanning-tree portfast								[disable spanning tree]

Switch(config)#interface range GigabitEthernet1/0/3 - 4					[configure any wired ports from switch to APs]
Switch(config-if)#switchport mode access								[since using a Wireless Controller, access mode to the APs]
Switch(config-if)#switchport access vlan 10								[allow vlans between the AP and switch]
Switch(config-if)#switchport access vlan 22<---wouldn't this replace the vlan 10 command? only one per access port usually
Switch(config-if)#switchport access vlan 23
Switch(config-if)#spanning-tree portfast								[disable spanning tree]

Wireless Controller Configuration
----------------------
get on a laptop connected to the network
ping the wireless controller 			[192.168.10.11 here]
via browser get to the ip of the Wireless Controller [192.168.10.11]
setup an AAA RADIUS server for authentication of users	[192.168.10.10 here]

create a dhcp scope on the Wireless Controller's side for corporate users
	via browser get to the ip of the Wireless Controller [192.168.10.11]
	dhcp scope > new
		name			   = wireless-dhcp-Corporate
		pool start address = 192.168.22.101		[corporate vlan subnet used]
		pool end address   = 192.168.22.254
		network			   = 192.168.22.0
		network mask       = 255.255.255.0
		default router     = 192.168.22.1		[corporate vlan Switched Virtual Interface port is the default gateway for traffic]

create a dhcp scope on the Wireless Controller's side for guest users
	via browser get to the ip of the Wireless Controller [192.168.10.11]
	dhcp scope > new >
		name			   = wireless-dhcp-Guest
		pool start address = 192.168.23.101		[guest vlan subnet used]
		pool end address   = 192.168.23.254
		network			   = 192.168.23.0
		network mask       = 255.255.255.0
		default router     = 192.168.23.1		[guest vlan Switched Virtual Interface port is the default gateway for traffic]

create a logical interface on the Wireless Controller in the Corporate vlan
	via browser get to the ip of the Wireless Controller [192.168.10.11]
	controller > interfaces > new
		name			   = wireless-controller-interface-Corporate
		port number 	   = 1
		vlan id			   = 22
		ip address		   = 192.168.22.2		[any ip not in the dhcp range will do]
		network mask	   = 255.255.255.0
		gateway			   = 192.168.22.1		[corporate vlan Switched Virtual Interface port is the default gateway]
		dhcp server		   = 192.168.10.11		[dhcp server will be the Wireless Controller for the APs, the switch will tell APs this]

create the wireless LAN named ‘corporate’
	via browser get to the ip of the Wireless Controller [192.168.10.11]
	wlans > new
		Profile Name	   = wifi-Corporate
		SSID			   = wifi-Corporate
		ID				   = 1
	wlans > edit 'Corporate'
		General
			Status				= Enable
			Interface Group		= wireless-controller-interface-Corporate
		Security > Layer 2
			Layer 2 Security	= WPA+WPA2
			WPA2 Policy			= yes
			WPA2 Encryption		= AES
			Authentication Key	= 802.1x	[we want employees to authenticate via our Radius server ]
		AAA Servers
			Server 1			= 192.168.10.10 [our radius server]

create the wireless LAN named ‘guest’
	via browser get to the ip of the Wireless Controller [192.168.10.11]
	wlans > new
		Profile Name	   = wifi-Guest
		SSID			   = wifi-Guest
		ID				   = 2
	wlans > edit 'Guest'
		General
			Status				= Enable
			Interface Group		= wireless-controller-interface-Guest
		Security > Layer 2
			Layer 2 Security	= WPA+WPA2
			WPA2 Policy			= yes
			WPA2 Encryption		= AES
			Authentication Key	= Pre-shared Key	[guests use a guest password for wifi, not the internal Radius server]
				secret			= password

!save the configuration!


=========================
>>>DNS setup
R1(config)#ip dns server                                        [configure R1 to act as a DNS server]
or
R1(config)#ip name-server 8.8.8.8                               [or tell R1 external DNS server name]
                                                                [only needed if R1 needs to make DNS requests, not route them!]

R1(config)#ip host R1 192.168.0.1                               [add a list of hostname and ip addresses]
R1(config)#ip host PC1 10.0.1.1
R1(config)#ip host PC2 10.0.1.2
R1(config)#ip host PC3 10.0.1.3
R1(config)#ip host VPN-servername-1 10.5.5.5

R1(config)#ip domain lookup                                     [enabled already by default - allow R1 to make DNS queries]
R1(config)#ip domain-lookup                                     [old command that still works]

>>>DHCP setup
-------------------------

Option 1: Cisco Router as DHCP server
--------------------------------------
R1(config)# ip dhcp excluded-address 10.10.10.1 10.10.10.10		[ip's assigned will be 10.10.10.11 - 10.10.10.254]
																[note: do this first so others aren't assigned these ip's!]
R1(config)# ip dhcp pool Clients								[create and enter dhcp pool 'Clients' config]
R1(dhcp-config)# network 10.10.10.0 255.255.255.0				[subnet for Clients pool, this is info given to dhcp clients]
R1(dhcp-config)# default-router 10.10.10.1						[default gateway address, given to dhcp clients]
R1(dhcp-config)# dns-server 8.8.8.8 							[dns server address, given to dhcp clients]
R1(dhcp-config)# domain-name jeremysitlab.com                   [domain name, for client names, ex: pc-01.jeremysitlab.com]                                    
R1(dhcp-config)# lease 1 5 30                                   [ip lease expiration time - 1 day, 5 hours, 30 minutes] 

###Verifying DHCP server running on a cisco router
show ip dhcp pool												[show dhcp settings and client summary]
show ip dhcp binding											[list dhcp clients]

Option 2: DHCP on a conventional server
----------------------------------------
	for this we just need to know how to route to the DHCP server, so from another router, do this:
R1(config)# interface fa0/1										[find the router port facing the pc's]
R1(config-if)# ip helper-address 10.10.20.1						[dhcp requests to this port should go to the DHCP server, which also does DNS]

IP commands for PCs
-------------------------
Windows
	ipconfig /all			[show ip info]
	ipconfig /release		[discard assigned ip's]
	ipconfig /renew			[retry DHCP request]

Mac
	ifconfig				[only ip and subnet mask]
	netstat -rn				[see default gateway]

Linux
	ifconfig				[old command]
	ip address show			[only ip and subnet mask]
	ip route show			[see default gateway]

Router Needing DHCP Lease for Public IP
---------------------------------------
int fa0/1														[find the router port facing the internet]
ip address dhcp													[enable DHCP leasing from the ISP]
no shutdown														[enable the port to start borrowing a public-facing IP via DHCP]

###Verifying DHCP lease
show dhcp lease


=========================
>>>HSRP setup
-------------------------
Router1# standby 1 ip 10.10.10.1								[activate HSRP for the default gateway ip, a virtual ip]
Router1# standby priority 110									[this should be the priority user of the default gateway virtual ip]
Router1# standby 1 preempt				[preempt mode on: this router will attempt to reclaim "active" mode after it went offline, becoming user of the virtual ip]
Router1# standby version 2

Router2# standby 1 ip 10.10.10.1								[both routers should have the virtual ip of the default gateway]
Router2# standby priority 90
Router2# standby version 2										[both routers must be the same version of HSRP]

###Verifying HSRP
Router1# show standby
"Active router is local" = this router is acting as the default gateway a.k.a. 'active mode'
"Standby router is local" = this router is in 'standby mode' rather than 'active mode'


=========================
>>>NAT Natural Address Translation
-------------------------
R1(config-if)# ip nat inside                                    [this interface will have check for internal ip's on its subnet]
R1(config-if)# ip nat outside                                   [this opposite interface is facing the internet and will send out the translated NAT addresses]
R1(config)# ip nat inside source static 10.1.1.23 232.21.56.42  [10.1.1.23 will be sent out as 232.21.56.42]
R1# show ip nat translations                                    [inside local = 10.1.1.23, inside global = 232.21.56.42]


=========================
Layer 2 & Layer 3 Motion
-------------------------
Data-frame + Packet motion
-------------------------

Switch hop, MAC addresses are stripped-off and new ones are put on (but the IP info in the packet stays the same)
	- MAC address is just figured out to get to the next hop of a long journey
	- Switch and router adds MAC address to its MAC table
Router does the FCS check then de-encapsulation by router of any Layer 2 frame such as Ethernet vs HDLC frame
	- Router adds IP address to its IP Route table
	- Adds HDLC encapsulation if going to another Router, or adds Ethernet encapsulation if going to a PC
Router determines what the MAC address should be to send out, and make it to the next hop 
	- Looks it up on ARP table
	- Sends it out and decrements the Time to Live counter, which would eventually expire the packet.  Only routers do this! (or Layer 3 switches)
	- If router determines the ip address is in a different subnet, it makes an ARP request to the router's default gateway
--------------------------
+ Routers receive broadcast messages on their ports/interfaces on that subnet
+ Routers do not forward broadcast traffic, by default



=========================
Layer 2 Protocols
-------------------------
+Cisco's REP replaces STP, spanning tree protocol replaced by resilient ethernet protocol
	- Prevents looping

+HDLC and PPP are for leased lines

-------------------------
+STP Spanning Tree Protocol
-------------------------
	- determine root switch, the switch with the lowest Bridge ID
	- determine fastest route to root switch, as weighted by arbitrary "cost" numbers assigned to cable speeds
            Speed       STP Cost
           10 Mbps      100
          100 Mbps      19
            1 Gbps      4
           10 Gbps      2
		- e.g. 2 hops via gigabit is much much less "cost" than 1 ethernet hop + 1 gigabit hop, and just 1 hop is ultimate
			- "root cost" along the root path. If a tie, it chooses lowest neighbor bridge ID, port priority, port #.
			- cost is based on configured operating speed of the port, not max speed of the port
			- You can give ports custom root costs
	- all ports disabled first then enabled after bpdu sent and routes figured out
	- bpdu = bridge port data unit, a unit sent out by the root switch for discovering appropriate STP routes
			- at first all switches send their hello bpdu, then when a better bridge ID is received, those are forwarded instead
	- bridge ID - all switches must be given a bridge ID #, the lower = higher priority, default is 32768, 0 - 65535
        - lower MAC address = tie breaker
		    - this can lead to the oldest switch being automatically chosen since newer devices have higher MAC addresses
	1. Root bridge selected by lowest bridge ID
            tie breaker - lowest mac address
        all its ports become designated ports
    2. Other switches select root ports
        Lowest root path cost - determines which switch
            tie-breaker - lowest Bridge ID
                Port ID - port selection tie breaker
                    not the local port - the neighbor port ID
                    ex. gi0/8 connected to gi0/1 vs gi0/4 connected to gi2/0
        their opposite port becomes a designated port
	3. Blocking state on all other ports
	- initial Hello bpdu is sent out to all by the root switch and then forwarded by next switch with new Bridge ID and cost #
		- the bpdu info contains Bridge ID and cost # updated on the received switch before next forwarding
		- There are actually three types of bpdu's, the Hello bpdu, a change notification bpdu, and change acknowledgement
	- "designated port" when a port is opened because it's optimal for receiving along the fastest root path
        - the other side must therefore be a root port
        - all root switch ports are designated ports, then it's the selected forward-looking port out of each switch
        - all ports to user devices will be 'designated' ports because no possibility for looping
	- "root port" opened port where the designated port wants to connect to. The other side of the cable.
        - this is actually selected by the switches via priority calculation, 
            but it looks like it follows the designated ports on a map, because the root switch starts with all designated ports and everything follows after that
    - "alternate port" - next up to be a designated port if that goes down
    - "non-designated" - port is in a blocking state 
	- root switch will have all ports open of course
	- "disabled" state means the port doesn't work
    - port states for normal traffic
        - blocking
        - forwarding
        - listening
        - learning
        - disabled
	- When bpdu's aren't received by MaxAge time the network thinks ports or switches aren't operating and reconfigures pathing
		- This also happens if the switch detects the receiving switchport is down for some other reason
		- when pathing is reconfigured the switches first determine if they're the new root switch or not
	- STP timers as configured by the root switch and contained in bpdu Hello frames
		- Hello - 2 seconds - The time period between Hellos created by the root
		- MaxAge - 10x hello's time - How long any switch should wait before trying to change the STP topology
		- Forward Delay - 15 seconds - 15s interim listening state, then 15s interim learning state, before changing ports
	- note that MaxAge + Listening + Learning period are 50 seconds. 20+15+15
	- if a switch doesn't receive a bpdu for a port within the MaxAge time, the port is blocked
	- Reconfiguration in transition - the listening and learning stages of a port deciding it should change
		- listening - no frames are forwarded, no new MAC addresses added, and stale MAC addresses are cleared (anti-loopz)
		- learning - no frames are forwarded and new MAC addresses are added
		- all changes in this way are from blocking to forwarding state at the end, apparently
	- Portfast skips STP for a configured port. Should only be connected to an endpoint
		!! Loop created if portfast port connected to a hub, router, switch because it causes problems with bpdu resolution
	!! Loop created if a rapid setting for max-age on frames expires them before bpdu can resolve
	!! Loop created if a switch connects that doesn't use STP, like a consumer switch
	- BPDUGuard disables ports that receive any bpdu
	- everything is Bridge, bridge domain, bridging loop, etc. because this started on bridges which were 2-port switches lol
	- remember the root port is just any port on the settled root path that sends data
	- STP not used anymore on Cisco switches, because only one tree allowed
	- problems if STP isn't used/doesn't work and a loop is caused:
		- max CPU
		- broadcast traffic crowding every other communication
		- MAC addresses changing and aren't reliable
	- Hello BPDU bits
		Source MAC, Destination MAC, Timer
	- "spanning-tree pathcost method long" - change switch to use the new cost scheme so faster speeds are weighted
	- You might want different root bridges on different VLANs so you balance traffic and don't have some ports always on block mode
	- Exact root hello bpdu process	
		- All switches start by advertising themselves as the root switch
		- If a switch receives a BPDU listing a higher-priority root switch
                - "Superior BPDU"
                - Tie-breakers:
                    - Lowest bridge ID
                    - Lowest MAC address
			- it stops sending itself as root in Hello BPDUs
			- Starts listing the superior root in Hello BPDUs
			- Each switch forwards the Hello BPDUs from the root switch, adding their own cost to root
			- The lowest cost path back to root is calculated
			- Lowest cost port becomes Root Port on that switch, others become alternate ports
			- Tie-breakers:
				- Lowest neighbor bridge ID
				- Lowest port priority
				- Lowest port number
	- When a switch fails
		- forwarding -> listening -> learning
		- ports not receiving hello bpdu after max age change all blocking ports to listening
			- max age is 10x hello timer = 2 x 10 = 20 sec by default
			- forwarding turns to blocking
		- when a port receives hello bpdu, change from listening to learning
			- finds lowest bridge ID and lowest path cost in hello bpdu received
			- since root switch is probably not this switch, only hello bpdu's from root are being forwarded
		- port receiving the root hello bpdu changed to forwarding
    - Bridge ID can only be changed in multiples of 4096, then the VLAN ID is added to it (if pvst is being used)
        - 32768 + vlan 20 = 32788
    - RPVST+ is used on Cisco switches - Rapid Per-VLAN Spanning Tree, an STP for each VLAN
        - can't have one STP in multiple VLANs
        - the "rapid" means faster convergence time
    - have to check the running-config to determine what spanning-tree mode is enabled

    - Broadcast storms - constant broadcast loops because ethernet data frames have no TTL expiration, they just go to all paths except original. Fixed by STP
        - could happen wherever there's a triangle or square of switches
    - MAC address flapping - repeated MAC table updates because multiple sources sending the same source MAC
	

+Resolving errors
	- remove redundancy connections

+VLANs
	802.1q - tagging in the frame
        32 bits / 4 bytes
        TPID - 16bits - Tag Protocol Identifier - "8100" in hexadecimal, identifying this is a vlan packet and it needs to be treated differently
        TCI - Tag Control Information
            PCP - 3 bits - Priority Code Point, used for CoS (Class of Service) prioritization, directing traffic in congested networks
            DEI - 1 bit - Drop Eligible Indicator - indicates if this frame can be dropped if this network is congested
            VID - 12 bits - VLAN ID - the VLAN number tagging all of this data frame. 12 bits = 4096 possible VLAN IDs
    trunks aren't necessary, they're just practical
    Reserved VLANS - 0 & 4095, so 4094 possibilities
    native VLAN mismatches are still received through all trunk switches, just not forwarded to any VLAN that doesn't match the NEW switch's native VLAN


+RSTP
	- works with STP switches
	- fixes paths within seconds, up to 10 seconds
	- all switches, not just the root switch, generate Hello's
	- switches define an "alternate port", the next best root port
	- switches can ask other neighbor switches if something is down
	- switches can choose to immediately failover to alternate ports and enable them as forwarding ports
	- no listening state. If not immediately transitioning, the port enters a learning state
	- "discarding state" now
	- uses one common STP
	- one set of hello bpdu
	- to multicast MAC 018.0c200.0000
	- sends BPDUs in the native VLAN on a trunk
	- ....(justin's notes)

+RPVST+
	- multiple vlans requires multiple STPs so new tech was needed
	- Rapid STP but for multiple trees, one per vlan
		- one STP instance for each vlan.  One switch may have 20 STP configurations to calculate.
	- Cisco's
	- "alternate ports" also = the blocking ports here
	Core1(config)# spanning tree vlan 1 root primary		[assign this switch as the primary for vlan 1]
	Core2(config)# spanning tree vlan 1 root secondary		[assign this switch as the backup root bridge for vlan 1]

+MSTP	- multiple spanning tree protocol, IEEE's version of Cisco's RPVST+, not limited to 1 per vlan

+PVST+	- cisco proprietary version of MSTP, older than RPVST+, still has long convergence times like normal STP because it's not RSTP-based

+settling on STP paths is called " STP convergence"


+ARP - Address Resolution Protocol is layer 2!
	1.	PC to Switch
	1.a	ARP Request: Source MAC = 1111.1111.1111.1111, Destination MAC = FFFF.FFFF.FFFF.FFFF, Destination IP = 10.10.10.1
		"I'm looking for 10.10.10.1, what's your MAC address?"
	2.a	Switch sends to all interface ports because it's a broadcast MAC address
	2.a.1	ARP reply: Source MAC = 1111.1111.2222.2222, Destination MAC = 1111.1111.1111.1111
		"ARP reply means I'm 10.10.10.1, here's my MAC address"
	2.a.1.a	IP packet sent from source to destination
	2.a.2	No reply, but a router receiving the request determines that the IP is beyond the current subnet
	2.b	Switch instead sends ARP request to default gateway, the router to send to other subnets
	2.b.1	ARP Request: Source MAC = 1111.1111.1111.1111, Destination MAC = FFFF.FFFF.FFFF.FFFF, Destination IP = 10.10.10.254
	Lasts 240 minutes by default
	"clear arp-cache" - clear the dynamically added (not manually added) entries
	"clear ip arp xxxx.xxxx.xxxx.xxxx" - clear a specific arp entry attributed to a specific ip address

+Autonegotiation
	802.3u
	Copper/Ethernet wires only, because you can't mix speeds with Fiber ports anyways
	Defaults to Half Duplex for 10mbps or 100mbps
	Defaults to Full duplex for 1GBps

-------------------------
+EtherChannel
-------------------------
+ a.k.a. LAG link aggregation protocol, "port channel"
+ can do the same with PC's/servers via NIC Teaming
+ EtherChannel groups ports into one link basically
+ Only one group per switch.  Different switch, different group number.

! Why even use it? Spanning Tree!  Spanning Tree will block the fuck out of your second high-bandwidth connection to the same device.

+ Dynamic linking discovery and configuration
	- Port Aggregation Protocol (PAgP) - Cisco's - max 8 ports on at once on a channel
	- Link Aggregation Control Protocol (LACP) - IEEE's - max 16 ports
			- preferred option
	- Static configuration
			- do it if LACP isn't supported on both sides
	- connection settings of other switch is actually done by Cisco Discovery Protocol if manually configuring
	- PAgP and LACP check for same settings like if they're all access ports or trunk ports (must be all same), VLAN lists, etc
		- auto-negotiates the port channel creation
		- "shutdown" then "no shutdown" to return the port from an err-disabled state
		- can error from something as small as STP cost mismatch on the ports towards the same destination
	- How does the receiving switch determine the MAC of the sender?? the port channel interface MAC (what??)

+ Loadbalances the ports, determining which one's turn it is to send it out
	- per session connection, not per packet sent
	- think of a multi-lane highway w/ walls on each lane - faster than the city streets, but you can't move between lanes
		
+ You want the configuration on both ends and each port to match as exactly as possible
	- speed
	- duplex
	- access mode or trunk mode
		- access mode: assigned vlan
		- trunk mode: native vlan + allowed vlans
	- both or at least one side should be configured "active", other could be "passive"

+ Layer 3 switch has to have the ip configged

+ Redundancy is a bonus benefit. if one port fails no problem

+VSS, +vPC, +StackWise are etherchannel protocols to group multiple chasis, which prevents spanning-tree blocking redundancy etherchannel setups
	- this is a common problem inherent to the architecture, because although etherchannel prevents spanning-tree blocking of a port,
		- the redundancy connections still form a loop, and so the far side will be blocked
		o----o
		 \   |
		  \  |
		   \ x
		    oo
		- this is still better because before etherchannel only one port would work each direction, but now we have an entire group
		o====o
		 \\ ||
		  \\||
		   \xx
			oo
	- not every switch supports one or more of these

-------------------------
VLANs
-------------------------
+VLANs are configured per port

+Global config mode has a channel for each vlan - this is for all your Layer 2 vlan stuff, not layer 3
(conf)vlan 2
(conf-vlan)

+"interface" configuration of the vlan is layer 3 stuff only -- actually it's just a virtual interface but it's always for vlan traffic anyways
	(conf)int vlan 11
	(conf-if)
	or
	(conf)int vlan11
	(conf-if)


+New MAC table for each VLAN.  All VLAN traffic is only within each Vlan. 4090 switches for the price of 1!

+show interfaces fa0/1 switchport					[shows VLAN information configured for the port]

+Show interfaces trunk
	Vlans allowed on trunk
		= configured on the port itself, not necessarily anywhere else
	Vlans allowed and active in management domain
		= VLANS configured on switch and not shut down
	Vlans in spanning tree forwarding state and not pruned
		= VLANs actually allowed on the network

! Switchport mode is by default auto


+All VLANS are not unallowed but only 1 is created automatically, along with 1002-1005 which are unusable
+Each 802.1Q encapsulation trunk has one native VLAN
+All ports are dynamic auto by default (DTP)



+DTP - Dynamic Trunking Protocol
	Default - dynamic auto
	non-negotiate mode - removes possibility of dynamic trunking
    Dynamic auto - if vs access or dynamic auto it becomes access. If vs trunk or dynamic desirable, its a trunk
    Dynamic desirable - tries to be a trunk port, unless other side is access
+switchport mode access - explicitly make the port for connections from the switch to a different type of device, like pc or router, can only use 1 vlan
+switchport mode trunk - can send any number of vlans, exclusively makes the port for switch-to-switch (or another trunking device)
+non-negotiate mode - removes possibility of dynamic trunking (other things?)
    - can't do "switchport nonegotiate" if it's in dynamic auto or dyanamic desirable, must be in only trunk or access mode
+native vlan - untagged, default vlan number.  Can be changed on a trunk port, but if an access port it's whichever single vlan that port uses
	- default native vlan is 1

+VTP - VLAN trunking protocol
	creates a database of VLAN configs and spreads it to each switch
	VTP Server
		- the default setting
		- switch that will spread to all
		- can add, edit, or delete vlans
		- spreads its info if db revision number is higher than neighbors and matching password
		- overrides its own db with any VTP server with a higher db revision number
	VTP Client
		- switch that will receive info
		- can't add, edit, or delete vlans at all
	VTP Transparent
		- no participation in VTP
		- must manually add VLANs to the VTP switch's switchports and the Transparent switch's switchports
	VTP bomb - if old switch with cleared configs still has VTP password that matches and a higher revision #, it spreads to all
	still need to config port-level vlan config on each switch
	If using both DTP and VTP, VTP domain name must match neighbor switches for trunking by DTP
	default is for switches to be in VTP Server mode, no domain name, no password
	SW1#vtp server ---> SW2#vtp transparent ---> SW3#vtp client (receives from vtp server)
	the native vlan doesn't get spread around, that's specific to the device
?   VTP pruning - 

-------------------------
+DHCP Dynamic Host Configuration Protocol
-------------------------
Automatically assigns
    - ip address
    - subnet mask
    - default gateway
    - DNS server
	- can add additional info, like the dedicated corporate ftp server
Actually layer 7 because it's a server
Layer 4 UDP transmission though

Ports:
    - UDP 67 - DHCP server
    - UDP 68 - DHCP client (the pc receiving and requesting info)

Broadcast or unicast b/c some clients won't accept unicast until they have an ip

4-step transaction
    - Discover
    - Offer
    - Request
    - Acknowledge

Steps
1. Client ----dhcp discover (broadcast)-------> DHCP server
2. Client <---dhcp offer (unicast/broadcast)--- DHCP server
3. Client ----dhcp request (broadcast)--------> DHCP server
        source 0.0.0.0, dest 255.255.255.255
4. Client <---dhcp Ack [info] (uni/broadcast)-- DHCP server

prefers to give the same ip the device previously had

DHCP relay agent transfers between subnets to/from the DHCP server
    - routers or layer 3 switches
    - otherwise the broadcast is dropped by the router
    - instead a unicast message is forwarded directly to the DHCP server
DHCP clients
	PCs
	Anything not running services other connections depend on
	- not servers
	- one router port facing the internet, for companies that need to borrow a public IP to NAT to the internet
		- these would be companies that don't need to buy public IPs but still of course want to connect to the internet
		- 'dhcp leasing' from the ISP or whomever
DHCP Architecture
	Option 1: Cisco Router as a DHCP server
	Option 2: External DHCP server, just a typical server computer
		- find the router port facing the PC's and configure the port to send DHCP requests to the DHCP server's ip address
Need to know how to verify and change settings on PCs for Windows, Mac, Linux
    (properties --> network ---> is "assigning ip address automatically" checked?)

R1(config)#ip dhcp excluded-address 192.168.1.1 192.168.1.10                [range DHCP won't assign]
R1(config)#ip dhcp pool TEST_POOL                                           [create a DHCP pool]
R1(dhcp-config)#network 192.168.1.0 /24                                     [dhcp ip range]
    R1(dhcp-config)#network 192.168.1.0 255.255.255.0                       [can use subnet mask instead]
R1(dhcp-config)#dns-server 8.8.8.8
R1(dhcp-config)#domain-name jeremysitlab.com                                [domain name, for client names, ex: pc-01.jeremysitlab.com]
R1(dhcp-config)#default-router 192.168.1.1                                  [default gateway]
R1(dhcp-config)#lease 1 5 30                                                [ip lease expiration time - 1 day, 5 hours, 30 minutes] 
R1#show ip dhcp binding                                                     [list dhcp clients that have been assigned ip's

R2(config-if)#ip helper-address 192.168.10.10                               [configure the port on the router of the same subnet as pc's, to point to the dhcp server]

PC01>ipconfig /release                                                      [windows pc: remove current dhcp ip assignment]
PC01>ipconfig /renew                                                        [windows pc: force pc to send a dhcp discover packet and start dhcp process]

PC-Linux>ifconfig                                                           [get ip info on linux or mac pc]
PC-MacOS>ifconfig

=========================
+Routers
-------------------------
+For directing traffic between subnets

Router packet steps
+longest subnet mask wins, if two similar routes exist
+FCS check on the dataframe, drops bad frames
+MAC address destination, drops if MAC isn't the router's MAC
+IP address compared to routing table
+Sent out

routes are only necessary for subnets beyond the direct connection of the router. It automatically knows routing for local connections
not every ip route configured ends in the routing table.  Routing table is only the preferred path after dynamic rip/ospf/etc calcs
	to show all static routes you have to check the running-config

show ip route - shows ip address and subnet size assigned on interfaces per the router
show arp - show arp table, with MAC Address

when routes overlap, the most specific route is chosen (the "longest prefix" e.g. 255.255.255.0 wins against 255.255.0.0)
when routes overlap and have the exact same specificity, it's load-balanced
you need to assign a gateway of last resort aka default route, e.g. 0.0.0.0 0.0.0.0 203.0.113.2 to the Internet Service Provider

summary routes reduce CPU load as changes in the network only affect other routers in the same area
summary routes reduce memory load as the router's table has less routes

static routes are almost always used for the internet path at the end of the network
static routes are used a little in most environments
dynamic routing automatically finds a new best path if a path disappears

hello packets are multicast nowadays, no longer broadcast
ip routes only found via hello packet discovery among same routing protocols

loopback interfaces are purely logical addresses using virtual ports that sends the information to itself
passive interfaces - interfaces that don't share internal routing info but can be discovered
	Doesn't send or receive hello's
!	Does advertise the network
	you want to put this on the last R in your network before the internet's router, on that specific port facing it
	loopback interfaces should always be configured as passive interfaces
		it saves hello packets
		allows harmless discovery

classless ip subnetting and addresses by default.  No respect for public vs private ip ranges, and no one cares

Routers and switches do not negotiate! Routers don't do dynamic trunking.  You define it as trunk or not, and that's it.
VLANs have to be in spanning-tree forwarding state on the switchport
!The router doesn't know how well the switch is working--if you look on the router and 5 of the 10 VLANs aren't even configured, it will still show up/up on those interfaces.

+SVI - Switched Virtual Interface (Layer 3 only)
	- logical (virtual) interface rather than physical, on the layer 3 switch itself, which can be used like a quick tiny router
		- so you don't need to pass the traffic to a far away router just to change vlans and subnets
	- If you have multiple VLANs on the same switch (very common) or multiple subnets, and you want to get from one VLAN to the Next
		- just create a tiny virtual router interface that lets you do it
	- When to use SVI vs Layer 3 Switch routed port
		- L3 SVI: Many ports on the switch need to be in the subnet
		- L3 Switch Routed Port: Only one port on the switch needs to be in the subnet
			- No need to configure a VLAN or assign it anywhere
			- Good for point-to-point links, e.g. between core devices or from a campus switch to WAN router
			- “no switchport” in interface config mode, then configure ip address…

+Routers have special interfaces like synchronous and async serial ports

+Routers typically have serial ports to connect to a CSU/DSU for leased line WAN connections
	CSU/DSU (channel service unit/data service unit) is a digital-interface device used to connect data terminal equipment (DTE), such as a router, to a digital circuit, such as a Digital Signal 1 (DS1) T1 line. The CSU/DSU implements two different functions. The channel service unit (CSU) is responsible for the connection to the telecommunication network, while the data service unit (DSU) is responsible for managing the interface with the DTE. A CSU/DSU can have an external connection point or it can be integrated into a modular card installed in a router.

+Routed switchports are for routers.  They require:
	- ip configured on the port
	- destination ip
	- next-hop ip address
	- (if on a layer 3 switch) "no switchport" command on the port to enable routed port mode
	- note that switches and regular switchports don't require anything.  If they don't know where to go, it broadcasts it everywhere!

-------------------------
Router Functionality & General Architecture
-------------------------
+ PCs --> Access Switches --> Distribution Switch --> Core Switch
+ You have different vlans? Great! But they're always for different subnets.  So you need a router to take them there!
+ Each interface port on a single router will be in a different subnet (in modern times, this is per virtual sub-interface port)
+ Every port on a router is disabled by default and needs a 'no shutdown' to enable it when configured, unlike switches
    - ipv6 is also disabled and therefore has to be enabled at each router port, for ipv6 ping to work for example
+ Types of routes
	- C - connected routes. Routes created because of physical connections from one switch to the other. /30 subnet mask.
	- L - local routes. The host address of this router's switchport on the connected route's subnet. /32 subnet because it's itself
	- S - static routes. Routes artificially added and typed into that specific routing table by a person.
	- Dynamic routes. OSPF, RIP, BGP, etc. routing protocols that learn and add routes automatically.

+ Routers need to know which addresses the next router has = router advertising, preferrably via summarization
	- These are preferrably in largest blocks possible, such as 192.168.15.0/24 rather than all 255 ips in that subnet
	- If the subnets are random then each one has to be advertised

+ Routers don't broadcast anything by default
+ Routers can't negotiate trunking, so the router and connected switch have to be manually configured for the trunking if chosen

+ Router to router connections get their own subnet
	- Layer 3 Switch to Layer 3 Switch connections also

+ The native VLAN can be configured on a subinterface, or on the physical interface, or ignored
+ if the router needs to route packets for a subnet that's in the native VLAN, it needs some configuration to support that subnet
	- Configure the ip address command on the physical interface, but without an encapsulation command
	- or
	- Configure the ip address command on a subinterface and use the encapsulation dot1q vlan-id native subcommand

+ 4 ways a router can work:
	- Use a router, with one router LAN interface and cable connected to the switch for each and every VLAN (this quickly becomes impossible)
	- Use a router, with a VLAN trunk connecting to a LAN switch (known as router-on-a-stick, or ROAS)
	- Use a Layer 3 switch with switched virtual interfaces (SVI)
	- Use a Layer 3 switch with routed interfaces (which may or may not be Layer 3 EtherChannels)

+ What Goes Onto the final Routing Table
	- as long as the interface is in an up/up state and has an IPv4 address configured
		- true for physical and logical (SVI) sub-interfaces on router or layer 3 switch

+ Routers are configured as access ports, not trunk ports

+ Router on a Stick
	no need for trunk config
	confirming ROAS
		show ip route connected
			Look for directly connected subnets that you configured under each subinterface
			Confirm ‘C’ and ‘L’ route codes
+ Default gateway is typically the distribution switch unless all the access switches are layer 3 switches
+ Access switches connecting to PC's, if layer 3 switches, would need to be the default gateway because each device is a new subnet

+ OSPF Areas
	Backbone Area 0--> ABR in both connected Areas 0 & 1--> Area 1 --> ASBR to non-OSPF area

+ Bandwidth per link
	- Recommended 20:1 PC to Distribution layer
		- 20 1Gb PC's ----20x1gb ethernet cables---> Access Switch ----20gb min link----> Distribution switch
	- Recommended 4:1 Distribution to Core switch

+ etherchannel used between switches usually
+ etherchannel often used on Wireless Controller
+ AP to Switch is access port if using Wireless Controller
	+ Wireless Controller to Switch is trunked
+ AP to Switch is trunk port if autonomous


+ Clustering - multiple of same devices that can act as one for management/feature purposes, but traffic capacity increased
+ Virtualization - hypervisor managing multiple OS's on one machine
    - Why not just install multiple apps on the same OS? Problems in one will affect the others! Also can conflict w/ processes, etc.
    - Type 1 - Bare Metal
            ex: vmware esxi, microsoft hyper-v, redhat kvm
            - for datacenters
    - Type 2 - Host Operating System > Virtual OS installed
            ex: VirtualBox, qemu, vmware fusion
            - for laptops
    - Virtual Switches and Routers are used!
        - handles multiple vlans and ips in virtual machines on the same physical machine
    - Firewalls are Virtualized! But only fancy places like internet companies
        - VRF - Virtual Route Forwarding is used instead at the enterprise level

+VRF - Virtual Route Forwarding (Not on exam, but cool)
    - separate routing tables on the same router, e.g. for different organizations
    - common for MPLS VPNs
        - because multiple people go through, so multiple routing tables are needed
    - layer 3 only - routed switchports (layer 3 switch ports with ip addresses), SVIs, or router interfaces
    - ip addresses can overlap without issues

+IaaS - Infrastructure as a Service
    - OS, apps, and data handled by customer, company handles everything else
+PaaS - Platform as a Service
    - custom environment used with Apps and Data handled by customer, company handles OS environment and all else
+SaaS - Software as a Service
    - Data entered by customer, customer uses the apps offered by company, company handles everything but data

+Cloud Computing
    - On-demand self-service
    - Rapid elasticity
    - Resource pooling
    - Broad network access

+Private Cloud - cloud created and used internally by the organization (scalable, pooled resources, on demand self-service, etc.)
    

-------------------------
+Wireless +Wi-fi +wifi
-------------------------
WPAN
	devices within 10 feet of eachother
	bluetooth often used
WLAN
	devices within 100 feet of a wireless router
	typically having wired connections as a core
!	multiple WLANS per AP, like Guest and Corporate wi-fi!
WMAN
	wi-fi across a city

"port" refers to physical ports only, and "interface" refers to virtual interfaces within the wireless controller


+Typical architecture
    - always "lightweight" mode:
pc01 - - - wi-fi - - -> Wireless "Access Point" - - - CAPWAP wifi tunnel - - -> Wireless LAN Controller ===== etherchannel ====> Layer 3 Switch 
    - Each wifi SSID is in a different VLAN    
    - APs placed in honeycomb pattern to avoid overlapping the same channels 
    - ETHERCHANNEL IS ONLY CALLED IT'S GENERIC NAME FOR WIFI SETUPS, LINK AGGREGATION GROUP (LAG) NOT ETHERCHANNEL    
    - etherchannel must be static, can't be any other type
    - going from different Vlans happens at the switch, not the WLC, so it goes there and then goes back out from the WLC 
            (Vlan01) pc01--wifi-->AP--capwap-->WLC==ethernet==>Switch (change Vlan via SVI Switched Virtual Interface)
    - disable spanning tree protocol on the switch port connected to the WLC
    - The motion flow is shaped because VLANs are needed for each SSID
        - Lightweight handles vlans through WLC-->Switch so all traffic has to go through there
            - This means Lightweight APs only need access ports
        - Autonomous AP can just bounce it to the local pc if nearby, no need to go to the switch
            - This means the Autonomous APs need a trunk port to a switch

+AP - wireless Access Point, the wireless router
	- Infrastructure Mode, centrally distributed bandwidth by a main AP, instead of AP-to-AP connections being peer-to-peer or ad-hoc
	- BSS - basic service set, the wifi, advertised by the AP for devices to connect to
		- the wifi radius of the AP
		- everything happens on one same channel
		- BSSID - unique ID for each AP's individual connection
			- AP's radio MAC address
		- SSID - name of the wifi connection, non-unique, can be multiple APs, can be silly
		- IBSS - ad hoc mode - "independent" BSS - wireless devices connect without an AP, like three laptops with Apple AirDrop sharing files together.
            - not scalable
	- BSA - basic service area, the wi-fi range, aka Cell
	- wi-fi is half duplex, meaning transfers wait for others to prevent collision
        - CSMA/CA used on half-duplex/wireless networks to avoid collisions - Carrier Sense Multiple Access with Collision Avoidance   
	- Repeater mode APs extend the BSS like a hub, but reduce throughput by half or more because it interferes as it spreads more signal
        - unless it uses two channels, one to receive and one to transmit out further
    - ESS - extended service set, multiple BSS b/c multiple AP's, but same SSID, same VLAN, different BSSIDs (multiple source locations for same SSID)
		- need different channels so the APs don't interfere with eachother
    - Lightweight is the normal type of AP	
    - Autonomous AP vs Lightweight AP
		- no Wireless Lan Controller vs uses a Wireless Lan Controller
		- these require different software images for installation
        - no seamless roaming!        
        - everything is individually managed, no WLC to control channels or transmission power
        - Trunk port must connect to it, Lightweight only needs access port b/c vlans go through the capwap tunnel
        - adds to spanning tree protocol blocking ports, reducing capacity
        - if you have 1000s of APs, you need 1000s of VLANs but you can only have 4096
        - good when acting as Repeaters, Outdoor Bridge, Workgroup Bridge
        - no load balancing
    - Cloud-based - the third type - lightweight vs autonomous vs cloud
        - Meraki is the Cisco AP solution for this
        - control and management traffic is sent to the cloud
            - channel info, etc.
        - data traffic is like Autonomous APs, sent directly to wire or nearby pc's
        - cloud dashboard handles channels and configurations, etc.
+Wireless Bridge - like a hub but for wifi and could bridge multiple direct cable connections on one side, but wifi always used somehow
+WGB - Workgroup Bridge - Router with wifi and ethernet that connects to your PC via ethernet cable, bridging you to the wifi (for PC's that can't use the wifi)
+p2p - Outdoor Bridge - point to point wifi connections.  ETH-LAN-A---Bridge---Wifi p2p>>>>><<<<<<<<Wifi p2p---Bridge---ETH-LAB-B
    - special focused signal so it goes longer than normal
    - can be point-to-multipoint which is like hub-and-spoke style also. One central antenna surrounded by a bunch of others.
+Mesh network - one radio frequency is used for clients, the other is used as a backhaul network connecting to more APs, extending the network
    - so you don't need an ethernet cable on each AP
    - the APs in the mesh network are all providing redundancy like normal switches    
    - MBSS - mesh bss
    - MAP - mesh APs (just a name)
    - Root Access Point - the AP connected to the wired network
+DS - distribution system, the ethernet cable etc. connecting to the AP that then spreads bandwidth everywhere
+CAPWAP tunnel - tunnel of traffic from AP to Wireless Controller
    - really there's two capwap tunnels per AP - the data tunnel and the control tunnel
+Wireless Lan Controller (WLC)
    - controls and configures and moves traffic from the wireless APs
    - initial setup is via command line interface, easily from the console port    
    - normal setup via GUI via https, unavailable via console port direct connection
        - http and telnet would have to be enabled. https enabled by default
	- Zero Touch Provisioning
		- APs discover the WLC and download settings via:
			- DHCP option 43 gives IP address of the WLC
				- most common
			- DNS - request for 'cisco-capwap-controller' resolves the IP address of the WLC
				- this DNS record has to be configured with the IP, it's not automatic
			- Subnet - broadcast would get reply of WLC
				- same Vlan and Subnet needed
	- seamless roaming of device between APs
		- otherwise, you'd have to reauthenticate when you move near a new AP!
	- reacts to wireless quality info from APs
	- controls channels and transmit power of APs
	- detects rogue APs - AP installed by someone else
	- performs non-real-time traffic for the AP, AP just worries about real-time traffic needs
		- called 'Split MAC'
			- WLC does:
				- Authentication
				- Roaming control
				- wireless to wired communication
				- radio frequency decisions
				- security
				- quality of service
			- AP still works:
				- client handshake
				- beacon info
				- decryption, encryption
				- performance monitoring, sent to WLC
				- clients in power save mode
        - physical port types the WLC can have
            - Service Port - dedicated management port, a segregated lane for anyone connecting and configuring the device
                - must connect to an access port on the switch because only one VLAN is supported
            - Console port - for physically connecting to a pc so you can configure the WLC in person
                - RJ45 or USB connection
            - Distribution system port - normal ethernet ports. The "distribution system" is just what wifi calls the normal data traffic
            - Redundancy port - to connect to another WLC so you can have 2 instead of 1
    - authenticates w/ AP's via x509 certificate
    - LAG mode, Link Aggregation Mode (generic Etherchannel) will make any failing etherchannels from the switch become functional LAG ports
+Lightweight modes
    - Local mode - normal mode    
    - FlexConnect mode
        - for when the capwap tunnel isn't working
        - AP acts like Autonomous AP and can forward to local MACs
	    - like WLC but for smaller offices that have a WLC far away in another building or something
	    - traffic just forwarded by the AP locally but you still have some centralized management
    - Sniffer mode - no BSS offered, just receives wifi 802.11 frames and sends them to a device running analysis software such as Wireshark
    - Monitor - no BSS wifi. Receives 802.11 frames to detect rogue devices and send deauthentication messages to the AP
    - Rogue Detector - no radio use at all. Listens to wired traffic and WLC tells it a list of suspected rogue devices, correlates it with ARP messages to detect rogue devies.
    - SE-Connect (Spectrum Expert Connect) - no BSS. Listens to all possible wifi channels and analyzes spectrum.
    - bridge/mesh - many APs in the middle of a bridge would make it be a mesh
    - Flex plus Bridge - FlexConnect + bridge/mesh mode 

+WLC Deployments (non-cloud, non-autonomous)
    - unified - WLC is an appliance in a central location in the network
        - 6000 APs supportable
    - embedded - WLC is in a switch
        - 200 APs per WLC
    - Cloud-based - WLC is a VM running on a server, in a private cloud in a datacenter. Not the Cloud-based AP architecture mentioned above. Still Lightweight APs.
        - 3000 APs supportable        
    - Mobility Express - WLC integrated in an AP
        - 100 APs per WLC

+Message types in Wifi
    - Data - actual data, the good stuff
    - Control
        - RTS - request to send
        - CTS - clear to send
        - ACK
    - Management
        - Beacon
        - Probe request
        - Probe response
        - Authentication
        - Association request
        - Association response

+Steps in a connection and transfer
1. Advertise the BSS
2. Association request to the BSS
3. Association - connection to the BSS
4. STA - Station - device connects to the BSS, such a stupid name
5. Data travels from device through AP
6.a. if 'autonomous', sends data to a trunked switchport
	6.a.1 vlan tagged by AP
6.b. if 'lightweight', sends data through CAPWAP tunnel to WLC
	6.b.1 no vlan tagging by AP, the WLC tags it and sends to a switch

+Unencrypted in transit unless WPA2, WPA3

+Bands and Channels
    - APs placed in honeycomb pattern to avoid overlapping the same channels
    - different per country
	- 2.4 Ghz - 2.4835 Ghz "band"
		- each channel is 22Mhz
		- channels 1, 6, 11 don't conflict (because these channels start every 5 Mhz so it takes 5 channels to get past 22Mhz)
            - this could be a problem in your apartment, because your neighbor is on a similar channel!
		- 14 channels total
		- more range, goes through walls better
		- more interference (microwave ovens, cameras, flourescent lights, etc.)
		- lower throughput
	- 5 Ghz - 5.125-5.825ghz
		- each channel is 20 Mhz
		- all channels don't overlap!
		- shorter range
		- less interference
		- higher throughput
		- can bond channels together to get higher data rate
			- but only in 2x, 4x, or 8x channels for the same data rate boost
			e.g. channel 1+2 = 20Mhz+20Mhz = 40Mhz, double data rate
			e.g. channel 1+2+3+4 = 20Mhz x 4 = 80Mhz, quadruple data rate
	- 802.11n - wifi, 2.4 & 5 Ghz, 600 mbps
		- backwards compatible with a,b,g
	- 802.11ac - wifi, 5 Ghz, 6.93 Gbps
		- backwards compatible with a,n

Standard    Frequency   Max Data Rate (theoretical)     Alternate Name
--------    ---------   ---------------------------     --------------
802.11      2.4ghz      2mbps
802.11b     2.4ghz      11mbps
802.11a     5ghz        54mbps
802.11g     2.4ghz      54mbps
802.11n     2.4 / 5ghz  600mbps                         'Wi-Fi 4'
802.11ac    5ghz        6.93Gbps                        'Wi-Fi 5'
802.11ax    2.4/5/6ghz  27.72Gbps                       'Wi-Fi 6'

+Wireless signal limitations
    - Absorption - weakened and partially converted into heat
    - Reflection - bounces off
    - Diffraction - hits something, travels around it
    - Scattering - reflected in all directions - dust, smog, etc.

+Wifi Authentication
    - WEP - old and unsecure
    - Open - no encryption
    - EAP - framework for authentication - Extensible Authentication Protocol
        - required for 802.1x
        - LEAP - lightweight EAP, unsecure, like WEP but more dynamic and requires both sides to authenticate
        - EAP-FAST - PAC, Protected Access Credential, sent from server TLS tunnel created between the device and authentication server, then authentication happens
        - PEAP - Certificate used by server instead of PAC, TLS tunnel created, authentication happens
        - EAP-TLS - Every device and server must have a cert, TLS tunnel only needed for encryption key exchange since everybody has a cert now
                - hardest to implement
+Wifi Encryption
    - WEP - old and unsecure
        - RC4 encryption
    - WPA (1)
        - TKIP - RC4 with extra, installed in devices until a better solution was possible
    - WPA2
        - CCMP encryption - AES + Cipher block chaining for integrity
    - WPA3
        - GCMP encryption - AES + Galois for integrity	
        - safe vs KRACK attack
        - PMF - Protected management frames, shields management frames from eavesdropping and forging
        - SAE - Simultaneous authentication of equals - protects the pre-shared key handshake
        - Forward secrecy - can't capture traffic over the air and decrypt it later
	- WPA Personal - a pre-shared key
        - this is the casual way. A password. like at a cafe or apartment
	- WPA Enterprise - 802.1x (centralized user identity) - calls a central identification server, which is probably connected to the Windows user Directory, and allows
        - each device would use an EAP method for this
    


-------------------------
Wide Area Networks (WAN)
-------------------------
+ LAN = 1 building basically
+ WAN = 2+ buildings, 2+ LANs, usually has to cross the internet to connect the two sides
+ MAN = municipality-provided internet
+ VPN - virtual private network, uses public links to create a tunnel for a private connection
	- Site-to-Site VPN
		PCs-->Switches-->Routers-->Firewall o========Site-to-Site VPN across internet=====o Firewall-->Routers-->Switches-->PCs
		- from the internet-facing firewall/router at one office to the same at the other site
		- doesn't require software on the desktop
		- IPsec security protocol often used
			- Symmetric encryption
		- locality oriented - doesn't work at home, it's just for the intranets where those firewalls are located!
		- Options:
			- IPsec Tunnel
				- no multicast
				- open standard
			- GRE - Generic Routing Encapsulation over IPsec Tunnel
				- on it's own, doesn't support encryption, so you need IPsec or other
				- adds support for multicast
			- IPsec VTI - 'virtual tunnel interface'
				- cisco proprietary simplified configuration, supports multicast
				- often used for site-to-site
			- DMVPN - dynamic multipoint VPN
				- cisco proprietary
				- hub-and-spoke style configuration that is translated into full mesh connectivity between offices
			- FlexVPN
				- cisco proprietary
				- newer version of DMVPN
			- GETVPN - group encrypted transport VPN
				- cisco proprietary
				- scalable centralised policy for VPN over non-public infrustructure e.g. MPLS
	- Remote Access VPN
		PC o======Remote VPN across internet=====o Firewall-->Routers-->Switches-->PCs
		- from user desktop to corporate intranet via the firewall/router
		- requires software on the desktop
		- SSL or Ipsec security protocols often used
+ WAN Connection Options
	- Leased Line
		- internet, site-to-site, or vpn
	- MPLS - multi-protocol label switching
		- shared core infrastructure at the internet service provider
		- internet or vpn
	- Satellite
+ SLAs - service level agreements
	- internet service provider will guarantee metrics for:
		- uptime
		- traffic delay
		- packet loss
+ Optical Fiber is used for long distances
	- DWDM - dense wavelength division multiplexing
		- combines multiple ('multiplexes') multiple optical signals into one signal and therefore one 'strand' (cable)
		- each signal is a different wavelength
		- therefore, more capacity without needing more cabling throughout the city
		- used in almost all longhaul optical fiber setups
		- this created a lot of no-longer-necessary fiber cabling
			- 'dark fiber'
			- can be rented out
+ Leased Lines
	- dedicated physical connection, reserved bandwidth
	- point to point
	- serial connection only (not true in the real world, ccna only)
	- same bandwidth both ways, fixed
	- office to office, or office to data center, usually
    - more expensive than other options
    - Fiber and Copper connections are becoming more common
    - T1,T2,T3,T4 speeds in USA, E1,E2,E3,E4 in EU
        T1 - 1.5 mbps        E1 - 2 mbps
        T2 - 6 mbps          E2 - 8 mbps
        T3 - 45 mbps         E3 - 34 mbps
        T4 - 275 mbps        E4 - 140 mbps
+ Satellite
	- just like leased lines
	- expensive
	- low speed
	- may be your only option
+ MPLS
	- runs on MPLS infrastructure, usually at Internet Service Provider
	- a VPN over the infrastructure for each customer
	- Layer 3 version
		- seems regular
		- you can see the ISP router on the other side giving you MPLS
	- Layer 2 version
		- you have to all be in the same subnet as the ISP and MPLS infrastructure
		- you can see every router and switch in the ISP's network
		- you basically join their network and they connect you with MPLS
        - VPLS - multipoint MPLS - Virtual Private Lan Service
        - VPWS - point-to-point MPLS, just one connection to the MPLS provider - Virtual Pseudowire Service
    - CE - Customer Edge network    
    - PE - Provider Edge network
    - P  - Provider Core network
    
+ Phone Lines
    - T1 and E1 were commonly used for connections to the PSTN, Public Switched Telephone Network
    - Analog phones in a house can carry one call
    - T1 can carry 24 calls, E1 can carry 30 calls
    - now it's VoiP and SIP over an ethernet WAN to the telephone company.
        - Voice Over IP
        - Session Initiation Protocol
    - Calls between different locations of the same company would be via leased T1 lines to avoid PSTN tolls
    - Calls outside the organization go to the PSTN

+Topology options
	+ Hub and Spoke - one center office w/ single connection to each other office
		+ Simple
		+ Centralized security
		- Single point of Failure
		- Suboptimal Traffic Flow
	+ Redundant Hub and Spoke - redundancy connections meshed between offices and hub
		+ Removes single point of failure
		+ centralized security
		- higher cost
		- suboptimal traffic flow
	+ Full Mesh - every office connected to every other office
	+ Partial Mesh - some office directly connected to each other, still a main center office
	+ Ring and super ring - like OSPF zones

+ Internet Redundancy Options
	+ Single Homed - single Internet Service Provider	|
	+ Dual Homed - two connections to same Internet Service Provider /\
	+ Multihomed - two Internet Service Providers ][
	+ Dual Multihomed - two ISPs with redundancy connections to each other ][X][

=========================
>>>Layer 3 Protocols
-------------------------
+ STP is actually layer 2
+ICMP
+load balancing is only for choosing routes, not packets.  One session will always go through the same route until the connection is lost
+multiple routing protocols are usually not used, but maybe the company merged with another

+Internet Protocol
	- TTL time-to-live value sets the amount of hops a dataframe can be routed, preventing endless looping

+HDLC - previously used for connecting your LAN to a WAN.  Faster connection onto a T1 that would receive data for the intermediary
	- point-to-point connections, so address field doesn't matter, although there is an address field
+EthernetWAN - not ethernet - ethernet emulation over MPLS - for ethernet connections to go across via MPLS, just encap and de-encapsulation

IGP vs EGP
	Interior gateway protocols for internal routing vs Exterior Gateway Protocols for routing outside the network
+BGP
	last EGP being used today
	path vector routing protocol

+IGP
	Distance Vector routing protocols
		RIP
		EIGRP
			cisco proprietary
		each router sends directly connected neighbors list of all known networks and distance to each of those networks
		router only knows what it's connected to and what it's neighbors are connected to
	Link State routing protocols
		OSPF
		IS-IS
		each router describes itself and its interfaces to its directly connected neighbors
		information passed unchanged from one router to another
		every router learns the full picture of the network including every router, its interfaces, and connections
	All IGPs load balance traffic between any equal cost multipaths by default

+RIP
	not used, unless small or test environments
	cost of routes = hop count, lower is better
		2 hops might be using slower connections than the other route with 5 hops!
		default max hops = 15, can be changed
		tie = load balanced, traffic divided among all paths
	RIPv1 is broadcast
	RIPv2 is multicast

+OSPF
    wildcard masks not subnet masks	
    cost = bandwidth (100mb, 10mb, etc.)
		on the OUTGOING port
	open framework usable by all routers
	more complicated to maintain than EIGRP
	tie = load balanced, but not round robin -- same session stays
!	Unlike static routing, you ONLY NEED to network the next-hop ip's for that device, NOT ALL IPs
	Packets
		hello packet - form adjacencies based on sent and received packets
		DBD - Database Description - tells adjacent routers the known networks
		LSR - Link State Request - sent to neighbors to fill missing information about a network
		LSA - Link State Advertisement - routing update
		LSU - Link State Update - list of LSA's which should be updated, used during flooding
			ex. when new link pops up or a link goes down, need to flood that info out using an LSU packet
		LSAck - Receiving routers acknowledge LSAs
	Steps of operation
		Discover nieghbors
		form adjacencies
		flood Link State Database
		compute shortest path
		install best routes in routing table
		respond to network changes
	224.0.0.5 = multicast address used for OSPF by the Designated Router ("DR") for that broadcast network
		There is also a Backup Designated Router ("BDR") which becomes the DR if it fails
		(no designated router is made for point-to-point links, of course)
	224.0.0.6 = multicast reply address used for OSPF by the other routers ("DROTHER") on that broadcast network
	States of OSPF
		Init - trying to reach 2-way connection
		2-way - 
		Full - all lists and information necessary exchanged
	"Full Adjacency" - full state
	"Adjacency" - full state, a.k.a. node is connected via OSPF and is a DR or BDR or is connected to one and is getting route info
	"Adjacent Neighbor" - same, but the neighbor
	"FULL/ - " the dash state means it's a point-to-point connection
	DR = Designated Router, which does all the sending for the subnet
	BDR = Backup Designated Router, becomes DR if it shuts down
	DROTHER = not a DR or BDR router, everyone else in the subnet
!		Drothers never become fully adjacent except with the two DR and BDR nodes
	DR & BDR Election
        per subnet
		Highest router priority  - (this is an OSPF setting on each interface. Priority of 0 = never. Default is everyone = 1)
			Highest router-id  - 255.255.255.255 would be the highest, 0.0.0.0 lowest name etc.
!				A new router connection created will NOT displace an already elected DR!
/n               (config-router) ospf router-id 69.240.69.420 to change the ID name manually
        no BDR elected if the router has no routers directly connected to it
	Each DROther reaches full state with the DR and BDR only
	Each DROther reaches 2-way state with the other DROthers
	LSDB = Link State Database, the state and route information shared via OSPF
	Stages of OSPF
		Hello...become 2-way neighbors
		Exchange Database Descriptions
		Exchange Link States...become fully adjacent neighbors
		Compute paths, install into routing table
	Adjacency Requirements--MUST be the same
		Hello timer
		both on each other's Neighbor list (Hello process works)
		Area ID (direct connections, each interface port can only contact those in the same area, routers can have multiple areas)
		Subnet
		Authentication Flag - same password if applicable
		Stub Area Flag - all connected links would need to be configured as a stub area as well.
		MTU - maximum transfer size of ethernet payloads (normal is 1500)
			This one is really weird because two-way adjacencies happen but can't reach full adjacency
		Router IDs can't be the same
	Areas
		Multiple areas may be necessary because the information grows exponentially with connections
		Area 0 = backbone area
		Area 1,2, etc. = connected to the border of Area 0, creating new areas like a sunflower petal
		ABR = Area Border Router
			has two OSPF Link-State DataBases, one for each area
		ASBR = Autonomous System Border Router - the border router to non-OSPF routers that will redistribute routes to other areas
		Stub Area - the link tries to go straight to the Area Border router
	LSA Types (OSPFv2)
		1 - Router - info about OSPF router itself - Router ID, interfaces w/ status, ip+mask, known neighbors
			"info about the house" metaphorically
		2 - Network - info about network - Designated Router and backup addresses, subnet ID and mask of network
			"info about the street" metaphorically
			one per subnet
		3 - Summary - subnet from another OSPF area - subnet ID and mask, router ID of border router, summary ip route
			"info about another city" metaphorically
			one per subnet in a different area
	Router ID
		just a name, but in IP address format, e.g. router-ID 2.2.2.2
		it should be an ip on the router because otherwise it's a confusing name
		defaults to any loopback or else the highest IP address on the router
		use a loopback because it never goes down
		can be manually set instead
	Making it work
		ABRs should connect one extending area to the the backbone area
		Summary routing should always be done on the ABRs, Area Border Routers.  They should be updating the links for their areas
		Summarization must be done manually
			or all traffic is flooded everywhere
        Process IDs can be the same even if different areas, it's just to locally distinguish between Area IDs on the device, like a pc process ID
	cost = reference bandwidth/interface bandwidth = lower score wins
		default reference bandwidth is 100Mbs
		100Mbs Fa0/1 vs 1000Mbs Gi0/1 = 100/100 vs 100/1000 = cost of 1 vs 1(rounded to 1). They're equal but shouldn't be!
		default reference bandwidth is 100Mbs so needs to be changed to 100000, else gigabit speeds aren't faster
		100Mbs Fa0/1 vs 1000Mbs Gi0/1 = 100000/100 vs 100000/1000 = cost of 1000 vs 100, Gi0/1 wins
		Cost along a path also counts the router itself
			R1->R2->R3 = 1+1+1 = path cost of 3
        loopback interfaces have a cost of 1!
	Adjacency Step-by-Step
		Hello packet-->
		<---Hello packet
		Valid neighbor check-->
		<--Valid neighbor check
		Link-State Database--->
		<---Link-State Database
			(higher router ID determines which LSDB overwrites any conflicting information)
		1. down state
        2. init state
        3. 2-way state <--DROthers say here
        DR/BDR election happens
        4. Exstart state - DBD packets, master/slave roles for db update server/client chosen <--MTU mismatch stays in Exstart+Exchange state
        5. Exchange state - DBD packets, describe content of Link State DataBase
        6. Loading state - LSR,LSU,LSAck : share LSAs to synchronize Link State DataBase
        7. Full state <--- DR and BDR only
        
			
IS-IS
	exam doesn't test on this much at all
	cost = manually configured per link
		if draw, lowest hop count wins
	used only by ISPs with MPLS networks because of scalability
	tie = load balanced
	another link state protocol

EIGRP
	cost = bandwith + delay, which is set by bandwith
		delay cost per bandwith can be changed if you want
	not a link state protocol
	can be configured to not load balance on equal cost paths
	easy to maintain
	cisco routers only though, basically
	calculates changes very quickly
	have to assign the router an AS#, a common number linking each router e.g. '(conf)router eigrp 100'
	cisco trusts this (90) more than OSPF (110) by default

Administrative Distance aka Administrative Speed
	measure of how trusted a certain routing protocol is
	used to choose between paths when multiple different protocols are used
	lowest cost wins
	Defaults
		connected interface 	0
		static route		    1
		external bgp		    20
		eigrp			        90
		ospf			        110
		IS-IS			        115
		RIP			            120
	[90/100] = administrative distance of 90, protocol cost measured at 100, probably EIGRP seeing a 100mb path
	10.10.1.2/24 [120/1] = 120 administrative distance, but RIP's protocol metric cost gave this route a cost of 1
	you can setup backup routes by manually changing administrative distance for static routes, only static routes
		ip route 10.0.1.0 255.255.255.0 10.1.3.2 115 <--- this 115 changes the administrative distance to 115
			OSPF is default AD cost of 110, if 10.1.3.2 doesn't use OSPF then 115 would use that route before RIP calcs

+ICMP (Ping & Traceroute)
	Really a layer 4 protocol! Transport layer!
	Doesn't use TCP or UDP -- uses ICMP
	If successful:
		no network problems on layer 1, layer 2, or layer 3
			Although this is layer 4, it's testing layer 3
		No Access-lists, inbound or outbound are filtering ICMP packets (other protocols could be filtered)
		Routes are in place
	Your router will miss issues if you don't ping from the source IP of the problem
		ex. PC1 can't access PC3, but your Router1 can ping Router 3.  You need to ping from PC1 by specifying the origin ip
	The ping menu can be opened by just typing 'ping'
	.!!!!		= first missed, 4 succeeded, this is common if router has to update arp table
	.....		= no successes, dropped packet
}	UUUUU		= ping blocked by ACLs or don't know where to route to
	ping sends from the closest port

	Traceroute use the TTL to pyramid ping until the destination, so TTL is just increased by one each time
		when TTL expires the last router knows to send back to the source IP address an "Unreachable" message
	!H 		= unreacheable.  Router at the last IP doesn't know where to send the packet.
	ctrl+shift+6 to abort

+IPv6
	routing (not switching) disabled by default
!		'ipv6 unicast-routing' in config mode to enable
}		but traffic would still work within the subnet!
    interfaces not enabled for ipv6 by default
        (conf-if)# ipv6 enable
	no such thing as broadcast!
	packet is treated like IPv4, header is created and dropped at each router hop (b/c might need to add HDLC tag, etc.)
	1111:AAAA:3000:ABCD:EF99:0000:2541:8888
	Each digit is a hexbyte, or 4 bits, so this is really 4x8x4 = 128 bit digits long!
	Subnetting - Count from left to right, each digit is 4
		1111:AAAA:3000:ABCD:EF99:0000:2541:8888/80 = 1111:AAAA:3000:ABCD:EF99:0000:0000:0000/80 = 1111:AAAA:3000:ABCD:EF99::/80
	You collapse the longest string of beginning zeroes with ::, and all leading zeroes are removed, trailing zeroes are kept
	NDP instead of ARP - Neighbor Discovery Protocol
	Routing table is separate than IPv4
	Protocol versions with IPv6
		RIPng	ripNextGeneration
		OSPFv3
		ICMPv6
		EIGRPv6
		IS-IS
		MP-BGP4 works also
	Abbreviation - remove all leading zeroes, replace largest string of all zero quartets with :: (do this only once)
	2340:0:10:100:1000:ABCD:101:1010/ 64  >>> 2340:0000:0010:0100:0:0:0:0 /64 = 2340:0:10:100::/64  
	3210:: ABCD: 101: 1010/ 64	      >>> 3210:0000:0000:0000:ABCD:0101:1010 = 3210:: /64
	2BCD:: FACE:BEFF:FEBE:CAFE/ 48	      >>> 2BCD:0:0::/48 but would be noted 2BCD::/48 ! (weird)
	210F:A:B:C:CCCC:B0B0: 9999: 9009/ 40  >>> 210F:000A:00::/40    but noted 210F:A::/40
	34BA:B:B: 0: 5555: 0: 6060: 707/ 36   >>> 34BA:000B:0::/36     but noted 34BA:B::/36
	3124:: DEAD:CAFE:FF:FE00: 1/ 60       >>> 3124:0:0:DEA0::/60   can’t drop trailing zeros
	2BCD:: FACE: 1: BEFF:FEBE:CAFE/ 56    >>> 2BCD:0000:0000:FA00::/56     can’t drop trailing zeros
	/64 is the easiest and gives enough room on both sides, so it's used all the time, even more than /24 in IPv4
	/128 will be automatic local routes or loopbacks
	"Global Routing Prefix" = Network prefix bits area (beginning part like in IPv4)
        first 48 bits, 12 digits, first 3 quartets, ex. FDEE:BBBB:CCCC:
        "Global ID" = whatever's unique in that first 48 bits, such as FD[EE:BBBB:CCCC] above
    "Subnet ID" = subnet range
        the next 16 bits, next quartet
    "Interface ID" = host number bits area (end part like in IPv4)
        the last 64 bits, the second half, last 4 quartets ::AAAA:BBBB:CCCC:DDDD
	Reserved addresses
		Unique Global Unicast - public internet, global - every address except the others
		Unique Local Unicast - Private
			FD00::/8
			Anything that starts with FD
			FD##:####:####:SSSS:????:????:????:????
				# = random number to identify the org, S = subnet , ?? = host ip ("interface ID")
		Multicast - 	FF00::/8
		- all hosts	FF02::1
		- all routers	FF02::2
            etc, see more below
		- routing protocols (various ipv6 addresses)		
		Link Local - 	FE80::/10
            not routed, only works on the subnet
            automatically created, like a ready-to-use assigned ip address for each port
            EUI-64 auto-generation rules
		Unknown -	0::0 aka ::
		Loopback	::1
	"Subnet router anycast address" = Subnet ID, all 0000's on the host bits
	EUI-64 addressing algorithm
		FD##:####:####:####:mac address + FFFE in the middle + flip 7th bit of host address (inside the 2nd digit)
		Flipping the 7th bit
			swap from higher to lower or lower to higher on each group
			0	1
			2	3
			
			4	5
			6	7
			
			8	9
			A	B
			
			C	D
			E	F
		Examples:
			2001:DB8:1:1::/64 + MAC 0[0]13.ABAB.1001 = 2001:DB8:1:1:0213:ABFF:FEAB:1001
			2001:DB8:1:1::/64 + MAC A[A]13.ABAB.1001 = 2001:DB8:1:1:A813:ABFF:FEAB:1001
			2001:DB8:1:1::/64 + MAC 0[0]0C.BEEF.CAFE = 2001:DB8:1:1:020C:BEFF:FEEF:CAFE
			2001:DB8:1:1::/64 + MAC B[8]0C.BEEF.CAFE = 2001:DB8:1:1:BA0C:BEFF:FEEF:CAFE
			2001:DB8:FE:FE::/64 + MAC 0C0C.ABAC.CABA = 2001:DB8:FE:FE:0E0C:ABFF:FEAC:CABA
			2001:DB8:FE:FE::/64 + MAC 0A0C.ABAC.CABA = 2001:DB8:FE:FE:080C:ABFF:FEAC:CABA
	You can use "ipv6 enable" on a WAN to WAN connection for both sides to not even do addressing and have auto-routing!
	Link Local Addresses in ipv6
		FE80:####:####:####:####
		used for troubleshooting and device discovery, no packets are forwarded
		automatically added addresses for every interface port!
		used for routing tables, so the next hop can be calculated by looking for the related device's MAC address
		can't be routed! only from the link port to it's other end, the immediate connection
		won't show up in any transfer packets, just for reference and communication only
	Multicast
		many different types
		Routers join ipv6 address groups
            FF01: interface-local - traffic doesn't leave the device
            FF02: link-local - traffic doesn't leave the subnet
            FF05: site-local - forwarded by routers within the WAN
            FF08: organization-local - for an entire company
            FF0E: global - anyone on the internet can tune in - but probably isn't forwarded by others so doesn't get far
            for any of these, can end with:                
                ::1  like   224.0.0.1   all nodes/hosts (like broadcast)
                ::2  like   224.0.0.2   all routers
                ::5  like   224.0.0.5   all ospf routers
                ::6  like   224.0.0.6   all ospf dr/bdr's
                ::9  like   224.0.0.9   all rip routers
                ::A  like   224.0.0.10  all eigrp routers
?	NDP - Neighbor Discovery Protocol
		ICMP Neighbor Solicitations and Neighbor Advertisements instead of ARP
		each ipv6 host listens for a Solicited Node multicast address that matches the last 6 hex digits of any of its ipv6's
		Technically this means each router joins its own ipv6 multicast address group
			ex: show ipv6 interface Gigabit Ethernet 0/0
				the link-local address is FE80::AA:AAAAA
				joined group addresses:
					FF02::1:FFAA:AAAA
	::, The Unspecified Address
		0000:0000:0000:0000:0000:0000:0000:0000
			::/0 is used as a default route (0:0:0:0:0:0:0:0/0)
			:: also used as the source ip when an interface is trying to acquire an address
    ::1 - the loopback address - 0000:0000:0000:0000:0000:0000:0000:0001 - traffic stays in the device
    No subnet mask in lengthy form like 255.255.255.0, just the /64 instead to write to the routing table
	IPv4+IPv6 routing = 'dual stack routing'
	Caveats
		Static routes pointing to a Link-local next-hop also need to specify an outgoing interface
		Static routes pointing to a GUA (or ULA) next-hop don’t need an outgoing interface
		Static routes pointing out Serial interfaces don’t need a next-hop
		ipv6 route prefix/length  [outgoing-int] next-hop
			Correct subnet ID (prefix)?
			Correct prefix length? (no spaces!)
		Outgoing interface correct? (must be an interface on local router)
		GUA / ULA next-hop: Next-hop address correct from remote router?
		Link-local next-hop: Outgoing interface correct for local router?
			Next-hop address correct from remote router?
        ipv4 can support 10.1.1.1 255.255.0.0 fa/01, but ethernet ipv6 can't use the next hop interface, has to have next hop address (could add exit port beforehand too)
            it works with serial cables though, so FD22:458C:3416::/64 s0/0 is valid

+Anycast Addressing
	ipv6, usually advertised with a /128 prefix (only one target possible)
	Multiple routers or hosts can have the same ipv6 or ipv4 address
		Sent to the nearest one


+SLAAC
	auto ip-addressing algorithm for IPv6
    same as the link-local address
		since there's so much IPv6 addresses, just gives out a formulaic address (EUI-64)
		don't need DHCP for assigning to random end-hosts joining your network!
			but you still need DHCP to send out DNS info, unfortunately
				this means both SLAAC and DHCP work automatically though and without retaining host information
					"stateless configuration", yay
	EUI-64 address is assigned
	not actually used for end-hosts in modern networks b/c privacy concerns (mac address = ip address basically)
		
+DNS
    UDP not TCP    
    A record = IPv4 + hostname
    AAAA record = IPv6 + hostname
    CNAME = same host, different hostname. 'canonical name'
    Local DNS server = for corporate hostnames
    Internet DNS server = for internet hostnames
    Devices save responses from the DNS server to their cache file, so repeated requests to the internet aren't necessary
    host file - file on pc that acts like a DNS server, before DNS was invented. Just a list of hostnames and IPv4 addresses. Takes 1st priority. Usually blank.

pc01> ipconfig /flushdns = windows CLI command to remove DNS cache

-------------------------
Subnetting
-------------------------
+If there were no subnets, there would be no boundaries for internet ownership
+If a computer wants to send data beyond its subnet, it has to do this via a router
+If your network was just one big subnet, it would be much harder to calculate and route network traffic
+Computers on the same network can't have the same ip address

192.168.10.15 = host, a PC = 11000000.10101000.00001010.00001111
255.255.255.0 = Subnet mask= 11111111.11111111.11111111.00000000 = anything in 192.168.10.x range is one subnet
192.168.10.0 = the bottom of the range, reserved as the network address for subnet routing
192.168.10.255 = the top of the range, reserved as a broadcast address to send to all devices on the subnet
# of hosts = 2^(32-subnet #)-2
# of subnets does not have this rule so don't -2

255.255.255.0 = /24, because 24 digits are used, 8 digits are free at the end, providing the addressable range
255.255.128.0 = /17, 11111111.11111111.10000000.00000000, 32-17 = 15 digits free = 2^15 = 32768-2 = 32766 
255.192.0.0   = /10, 11111111.11000000.00000000.00000000, 32-10 = 22 digits free = 2^22 - 2 = 4194302

+ So /31 don't have any available hosts, because there's only 2 ip's.  Cisco allows /31 only for point-to-point connections on routers.
?+ /32 can be used for loopback addresses, since the data isn't going anywhere
+ On the CCNA exam, if you need a subnet for two hosts, you must use /30 subnet, unless explicitly told otherwise
+ 8 hosts cannot be supported by /29, because of the broadcast and network addresses! Only 6 hosts supported.  Have to use /28.
+ 2 hosts are /30, not /31 for the same reason
+ Subnet ranges don't start or stop on the ip address, they start at the start of the nearest possible range that can contain it
+ Ex: What are the network address, broadcast address, and valid host addresses for the IP address 198.22.45.173/26? Subnet mask?
	- Subnet mask would be /26 so 255.255.255.192 (11111111.11111111.11111111.11000000 = top 2 bits of a byte = 128+64 = 192)
	- 198.22.45.173/26, 32-26=6 digits free, so 2^6=64, so ip range would be nearest available in blocks of 64, 128+64 = 192 (has 173)
		- network address is 198.22.45.128
		- the total range will be 198.22.45.128-191 (not 192!)
		- 198.22.45.128+64 (n-1) = 128+63 = 191 = 198.22.45.191 is the last address, so the broadcast address
			(we minus one here because 198.22.45.192 will be the next address in the next subnet!
			- 198.22.45.191 is the broadcast address
				- this leaves 198.22.45.129 through 190 as available addresses =  62 addresses (not 61! not 64!)
+ Ex 2:For the IP address 60.15.10.75/19, what is the network address, broadcast address, and range of valid IP addresses?
	- not asked, but Subnet mask would be 11111111.11111111.11100000.0000000, 255.255.224.0
	- 5 digits free in 3rd octet, so 2^5=32, so range exists in a block of 32, 0+32=32 (this has the 10 from 60.15.10.75 so it's good)
		- network address is 60.15.0.0
		- range is 60.15.0.0 - 60.15.31.255 (not 60.15.32.255!)
		- boradcast address is 60.15.31.255
		- valid hosts are 60.15.0.1 - 60.15.31.254 = 2^(32-19)-2 = 2^13-2 = 32768 - 2 = 32766 hosts available

+Subnet mask vs wildcard mask
	Subnets do NOT use wildcard masks, they use subnet masks
	Subnet mask of 255.255.255.252 = Wildcard mask of 0.0.0.3

	Wildcard mask		Bits			Results
	0.0.0.0				00000000		exact match
	0.0.0.3				00000011		Select the first 4 in the subnet
	0.0.0.248			11111100		Select the first 248 in the subnet


+You CANNOT type in 10.1.80.26 10.1.80.0/24, you have to type in the full subnet mask in ip format



-------------------------
IP Address Design
-------------------------
+ IP address blocks should be contiguous flowing upstream so router advertising takes much less space
	- Routers need to know which addresses the next router has
	- 10.0.1.0/24, 10.0.2.0/24, 10.0.3.0/24, ... 10.0.255.0/24 can be all advertised as 10.0.0.0/16, instead of each block or address

-------------------------
Redundancy
-------------------------
Routers to internet backup ONE path to another router, and backup ANOTHER path towards a router if the local core switch fails
Switches should be connected to TWO other switches (like a right triangle pointing down)
	access switches don't have redundancy connections - - pc's only have one network card
		unless it's for servers, then yes
Static routing for redundancy:
	Give backup route slightly higher administrative distance
		ip route 0.0.0.0 0.0.0.0 10.10.10.2 5 <---- 5 is the admin distance, slower than 1 for static routes
		local connections would have admin distance of 0, so any static route would already be slower
+FHRP - first hop redundancy protocols
	two options and one variant, for router redundancy
	+HSRP - Host Standby Router Protocol
			- Cisco version of VRRP
			- virtual IP and MAC used for the default gateway, another router uses it when the first router fails
				- "active/standby", one is active, other on standby
			- should align with your STP routes to minimize hops
	+VRRP - Virtual Router Redundancy Protocol
			- open source version of HSRP
	+GLBP - Gateway Load Balancing Protocol
			- Cisco devices only
			- default gateway is load balanced (both or more routers are "active/active")

+HSRP (more)- Host Standby Router Protocol
	- Cisco version of VRRP
	- virtual IP and MAC used for the default gateway, another router uses it when the first router fails
	- "active/standby", one is active, other on standby
	- Priority and pre-emption
		- higher priority setting will prefer a routing
			- default is 100, higher the better
			- in tie, highest IP wins
		- preemption means the higher priority router will re-claim the "active" usage of the virtual gateway after the router fails
			- disabled by default
			- if R1 has priority of 110, R2 has 90, and R1 fails and goes offline, then R2 becomes active, when R1 comes back it becomes the "active" gateway router
			- this is bad actually because if R1 is flapping on an off because of intermittent issues, there's a loss of connectivity each transition
			- really only needs to be configured on the highest priority router, if at all, but w/e
	- two janky ways of load balancing with HSRP:
		- two HSRP groups - configure half of all pc's on one gateway, half on another, make both routers have alternate priority for both virtual gateway ip's
		- alternate subnet priority - R1 priority 110 on each virtual gateway for subnet 1,2,3, R2 priority 110 for subnet 4,5,6, each has priority 90 elsewhere
	- should align with your STP routes to minimize hops




=========================
Layer 1
-------------------------
+Twisted Pair cables are for connecting similar devices
	- the directions are reversed, one copper wire going one way and other copper wire going a different direction
	- switch to switch, router to router, etc.
+Straight Through cables are for connecting different devices
	- computer to router, router to switch, etc.
+Fiber-optic cables are for longer distances or higher bandwidth
	- building to building	
+RJ-45 is the connector at the end of standard ethernet cables
+Rollover cables - terminal to console port in the router, pins switched from one end to the other

=========================
Layer 1 Setup / Physical / Ethernet Commands
-------------------------
(config-if)speed 10					    [force physical speed 10Mbs instead of default]
(config-if)clock rate 64000				[serial interface only - transmit at 64kb/s instead. Must be configured on both sides of the link]
(config-if)bandwidth 768				[change how fast the switches/router "consider" this port for path cost/routing determinations]

=========================
Security Random List
-------------------------
ip ssh version 2
transport input ssh	[all vty lines must now use ssh instead of telnet]
(config-if)ip ospf authentication-key c1$c0
(config-router)area 0 authentication

=========================
>>>Security for Switches
-------------------------
+Shut down unused switchports

+ DHCP Snooping - prevent rogue dhcp servers (often non-malicious) from access switches
	- trusted ports only for DHCP responses, or packet dropped

DHCP Snooping Setup
---------------------
SW1# ip dhcp snooping					[turn it on]
SW1# ip dhcp snooping vlan 10			[enable for the vlan]
SW1# int f0/1							[select trusted port]
SW1#  ip dhcp snooping trust			[add to trust list]

+Dynamic ARP Inspection - DHCP traffic inspected and dropped if host MAC address doesn't match what's assigned
	- hackers spoof a legit IP address along with their different MAC address
	- requires DHCP snooping already enabled
	- your devices that don't use DHCP need to be trusted ports if linked to this switch

Dynamic ARP Inspection Setup
----------------------
SW1# ip dhcp snooping					[turn on dhcp snooping]
SW1# ip arp inspection vlan				[turn on dynamic arp inspection]
SW1# int f0/9							[find device connected to switch that doesn't use DHCP]
SW1# ip arp inspection trust			[add to arp inspection trust list]

----------------------

+802.1x Identity Based Networking - only authentication traffic is allowed on host ports until authenticated by an identity server
	- All PC OS's can and must be ready to send 802.1x authentication request information
	- Switch relays that traffic to an identity server, from cisco or otherwise, probably connected to an Active Directory Controller
		- authentication is ok'd, traffic is allowed
		- switchport is actually changed to allow only the vlans allowed for that specific person!
    - requires EAP authentication methods    
    - supplicant - device wanting to connect
    - authenticator - switch or wireless AP
    - Authentication Server (AS) - device that receives client credentials and permits access
------------------------

+Port Security
    - only Switches	
    - Lock down ports so that:
		- only administrator can say which MACs use the port (useless because of MAC spoofing)
            - still useful to limit total number of learnable MAC addresses to prevent MAC flooding attacks
		- only one MAC address can use the port at a time, and since we already connected it, no more funny business from other people
            - MAC address limits can be any amount
                - You'd want two for a PC and phone connecing to the same switchport (pc's-->phone-->wall port)
    - can't be setup on dynamic ports - only switchport mode access or switchport mode trunk - not switchport mode dynamic auto or desirable		
    - 3 options
		Shutdown (default) - port shuts down when another MAC attempt occurs!
            - Syslog and/or SNMP message created if interface is disabled
            - violation counter +1 when unauthorized MAC attempt
		Protect - allow trusted MAC traffic, reject elsewise, but silent - no shutdown, no logging, no violation counter
		Restrict - allows trusted MAC traffic, logs violation attempts, increments violation counter
    - Default allows 1 MAC learned
	- Restoring Locked Down Ports
			1. physically remove the offending MAC address
				2. shutdown, then no shutdown the interface
                    3. violation counter will reset to 0
		- 'err-disabled' state when locked down
            - "err-disabled" is a general state noticed on the ports, which could be for 100 different reasons
		    - can configure to restore after x seconds, for the specific port security reason
    - "Secure MAC address" = the MAC address allowed on the secured ports
        - "static" - manually entered
        - "dynamic" (defualt) - learned as the MAC attempts the port
        - "sticky" - learned but added to the running config and never age out ever. Listed as Static in show MAC commands.
    - Aging
        - in minutes
        - infinite by default        
        - only dynamically learned MACs will age out by default, if aging is enabled
            - need another command to age manually entered secure MAC addresses
        - Absolute (default) - after x minutes, the MAC is removed and open for re-learning
        - Inactivity - timer refreshes each time the secure MAC passes through the switch
    - Sticky port
        - dynamic learned MACs on the port are added to the running config!
            - will look like this in the config: switchport port-security mac-address sticky AAAA.BBBB.CCCC
            - shows as type STATIC in the secure MAC list, even though it's added dynamically
            - NOT a mode! Default shutdown mode is probably still active.
        - never ages out, no matter what options you choose
        - converts all previously learned secure MACs to the running config as sticky MACs
        - re-converts sticky to dynamic MACs when you remove the setting

SW1# interface f0/10
SW1(config-if)# switchport port-security							[turn on port security, next MAC attempt will be the secure MAC]
SW1(config-if)# switchport port-security violation restrict			[turn on restrict mode, blocking and logging violations, never shutting down]
SW1(config-if)# switchport port-security mac-address 1111.2222.3333	[specify a specific mac address if you want -- don't ever do this]
SW1(config-if)# switchport port-security mac-address sticky			[OR learn whatever connects and use that as a sticky MAC]
SW1(config-if)# switchport port-security maximum 1					[only 1 MAC allowed]

SW1# int fa0/1
SW1(config-if) switchport port-security maximum 2					[increase maximum MACs allowed to 2]

SW1(config)# errdisable recovery cause psecure-violation			[enable automatic lockdown restoration of a port]
SW1(config)# errdisable recovery interval 600						[every 10 minutes after lockdown]

SW1(config-if)#switchport port-security aging time 120              [remove MAC addresses after 2 hours]
SW1(config-if)#switchport port-security aging type inactivity       [change to refress the age unless 2 hours of no secure MAC traffic]
SW1(config-if)#switchport port-security aging static                [age even the manually entered secure MAC addresses on this port]

###Verifying Port Security

#show port-security

Secure Port MaxSecureAddr CurrentAddr SecurityViolation Security Action
               (Count)       (Count)        (Count)
--------------------------------------------------------------------
       Fa0/18        1          0                 0         Shutdown
----------------------------------------------------------------------

#show port-security interface fa/02

Port Security              : Disabled
Port Status                : Secure-up  <------- "Secure-up" - The link is up and security is also working
                                                 "Secure-down" - if link is down
                                                 "Secure-shutdown" - port locked because maximum violation attempts reached
Violation Mode             : Shutdown
Aging Time                 : 0 mins
Aging Type                 : Absolute
SecureStatic Address Aging : Disabled
Maximum MAC Addresses      : 1
Total MAC Addresses        : 0
Configured MAC Addresses   : 0
Sticky MAC Addresses       : 0
Last Source Address:Vlan   : 0000.0000.0000:0
Security Violation Count   : 0

#show port-security address

               Secure Mac Address Table
-----------------------------------------------------------------------------
Vlan    Mac Address       Type                          Ports   Remaining Age
                                                                   (mins)
----    -----------       ----                          -----   -------------
   1    AAAA.BBBB.CCCC    STATIC <--could be sticky     Gi0/1   600
-----------------------------------------------------------------------------
Total Addresses in System (excluding one mac per port)     : 0
Max Addresses limit in System (excluding one mac per port) : 1024

#show mac address-table secure

               Secure Mac Address Table
-------------------------------------------------------------
Vlan    Mac Address       Type                          Ports   
                                                                
----    -----------       ----                          -----   
   1    AAAA.BBBB.CCCC    STATIC <--could be sticky     Gi0/1   
-------------------------------------------------------------

#SW1(config)# show errdisable recovery

ErrDisable Reason           Timer Status
-----------------           ------------
psecure-violation           Enabled

Timer interval: 600 seconds

Interfaces that will be enabled at the next timeout:

Interface       Errdisable reason       Time left(sec)
---------       -----------------       --------------
Gi0/1           psecure-violation       149


=========================
>>>Security for Switches & Routers
-------------------------

+ACLs - Access Control Lists
	- Filter packets based on
		- source ip
		- destination ip
		- port number
	- off by default
	- also used for Quality of Service prioritizing traffic, or Network Address Translation
    - we use these on routers during training, but the commands work on switches too, just can't apply to interfaces...
	- permit or deny rules
		- "ACE" access control entry
		- each row in the list is a different rule
		- uses wildcard masks, inverse of subnet masks
		- Standard version is just:
		  99 allow 10.9.8.7 0.0.0.255
		  <priority> <action> <source> <wildcard mask>

		- Extended version:
		  100 deny tcp 10.10.30.0 0.0.0.255 gt 49151 10.10.20.1 0.0.0.0 eq 23	<option>
		  |		|	|		|		|		|	|		|			|	|	|		other option, etc.
		  |	 action	|		|		|		|	|		|			|	|	port (optional)
		  |		 protocol	|		|		|	|		|			|	equals (optional)
		  priority		  source  wildcard	|	|	 destination wildcard
											|	port
										greater than
		- protocol = IP protocol
			- permit udp
			- permit tcp
			- permit ip = all traffic
			- permit icmp
			- permit ospf
			- etc.
		- source = #.#.#.#, any, host
			- "host" means automatic mask of 0.0.0.0, so it's that specific host
			- access-list 15 deny udp 10.10.4.5 0.0.0.0
			- access-list 15 deny udp host 10.10.4.5
			- access-list 25 allow ip 0.0.0.0 255.255.255.255
			- access-list 25 allow ip any
		- options
			- can be any combo of them at the end
					25 allow ip 10.24.33.0 0.0.0.255 10.10.20.1 0.0.0.0 eq telnet log
			- operators
				- gt = greater than
				- eq = equals
				- lt = less than
				- neq = not equal
				- range = port range
			- port
				- can use well-known names
					- telnet
					- www
					- echo (ping, but the protocol section must be icmp not tcp or udp!)
			- extra options
				- log = logs to the console or an external server, when a match occurs
					- match counts are already shown in the 'show access-list ###' command
						#show access-list 15
						#access-list 15 deny udp 10.10.4.5 0.0.0.0 (4 matches)				[shows 4 hits counted recently]
				- ack = match on the ACK step
				- fin = match on the FIN step
				- syn = match on the SYN step

	- Standard, Extendend, or Named ACLs - these are like the "file names" of the ACL
		List # range		classification		functionality
		1-99				Standard			source ip only!
		100-199				Extended v.2		port, source ip, destination ip
		1300-1999			Standard			source ip only
		2000-2699			Extended v.2		port, source ip, destination ip
	- Standard ACL range has a default wildcard mask of 0.0.0.0
	- Extended ACL range has no default mask!
		- you'll get an error
	- Named ACL has to specify which range, extended or standard, it's going to use, and is normal otherwise
		- it's just not limited to a stupid number from the list ranges
	- Standard ACL should be on a device as close to the destination as possible
		- it's so blunt
	- Extended ACL should be on a device as close to the source of the traffic, as possible
	- ACL rules to remember
		- ACLs are only applied at each interface via the 'access-group' command
		- ACLs can be applied as inbound, or outbound
		- can't have two inbound ACLs per interface or two outbound ACLs per interface
		- from top to bottom, lowest priority number to highest
		- anything lower is not applied once a match occurs
		- put most specific at the top, most general at the bottom
		- implicit deny at the end of all ACLs, denying everything not specified
		- in and out are perspectives of the device, so whether an ACL on a switch or a router, it's whatever that device experiences
		- can't filter self-generated traffic
		- one ACL per interface, per direction, per IP protocol (not per port)
		- ACL entries are automatically incremented in priority 10 per entry
			- 1st entry in ACL #90 will be priority 10
			- 3rd entry in the ACL #110 will be priority 30
		- ACL priorities can be displaced by a rule injection with a custom priority using the syntax of a named standard ACL
		- standard ACLs can only be completely removed and entirely rewritten, unless you only need to change priority
		- there is NO way to know which ACLs are applied to which ports other than 'show running-config | <search specifics here>'
        - if excluding, don't forget to put permit any any at the end! deny any any is the default.
    - ping 'timed out' = acl inbound is blocking it
    - ping 'unreachable' = acl outbound is blocking it

>>>ACL Setup
R2(config)# access-list 100 deny tcp 10.10.30.0 0.0.0.255 gt 49151 10.10.20.1 0.0.0.0 eq 23		[create an acl numbered '100', this will be priority 10, 1st entry]
R2(config)# access-list 100 remark <enter notes here for this acl>								[add a note for acl list #100]

R2(config)# access-list 90 deny tcp 10.10.25.0 0.0.0.255	    [create acl numbered '90', first entry will be automatic priority of 10, next will be 20, etc.]
R2(config)# int fa0/4
R2(config-if)# ip access-group 90 out							[assign the access list 90 to fa0/4 outbound traffic]
R2(config)# int fa0/2
R2(config-if)# ip access-group 90 in							[fa0/2 also uses access list 90 but for inbound traffic]
R2(config)# access-list 90 permit tcp 10.9.12.0 0.0.0.255	    [add another entry to access list 90, applying to any router ports using it]

R2(config)# ip access-list standard MaxACL					    [create a named ACL in the standard range called MaxACL and enter the configuration menu for it]
R2(config-std-nacl)# deny tcp 10.10.25.0 0.0.0.255
R2(config)int# fa0/3
R2(config-if)# ip access-group MaxACL in						[apply access list MaxACL to fa0/3 inbound traffic]

R2(config)# ip access-list extended SuperACL
R2(config-ext-nacl)# permit tcp 10.10.30.0 0.0.0.255 gt 49151 10.10.20.1 0.0.0.0 eq 23
R2(config-ext-nacl)# permit tcp 10.2.2.0 0.0.0.255 host 10.6.6.6 [replacing wildcard 0.0.0.0 for targeting 10.6.6.6 only by typing 'host' before the ip instead]
R2(config)# int fa0/3
R2(config-if)# ip access-group SuperACL in						[apply access list SuperACL to inbound traffic of fa0/3]

R2(config)# ip access-list standard 40						    [named ACL functionality also works for updating older Standard range ACLs]
R2(config-std-nacl)# 15 permit udp 10.10.17.0 0.0.0.255		    [give it priority between the first automatic entry [10] and the 2nd [20] ]
R2(config)# int fa0/4
R2(config-if)# ip access-group 40 out							[apply access list 40 to fa0/4 outbound]

###Verifying ACL
show access-list
show access-list 999

R2#show access-list
Output:
Standard IP access list 1
    10 deny 10.0.2.0 0.0.0.255 (14 match(es))				[14 packets were denied because of this ACL, on all of the router ports using it]
    20 permit 10.0.0.0 0.255.255.255 (91 match(es))
Extended IP access list 101
    10 permit tcp host 10.0.1.10 host 10.0.0.2 eq telnet
    20 deny tcp any any eq telnet (12 match(es))
    30 permit ip any any
Extended IP access list MaxACL
    10 permit tcp host 10.0.1.10 host 10.0.0.2 eq telnet
    20 deny tcp any any eq telnet
    30 permit icmp host 10.0.1.11 host 10.0.0.2
    40 deny icmp any any
    50 permit ip any any


=========================
Security Threat Landscape
-------------------------
+ IDS - intrusion detection system - sits along traffic flow and alerts system admins
	- may tell the firewall to block attacks
+ IPS - intrusion prevention system - sits inline traffic and can also block attacks
	- can slow down network traffic
		- can resolve via clustering the devices, if possible
+ IPS vs Firewall
	- IPS reads file signatures and behavior analysis to block traffic
	- Firewall uses rules to block traffic
+ Next Gen Firewall
	- Firewall + IPS + VPN tunneling
	- Stateful inspection
		- not just basic rule
		- if a session is connected, the return traffic could be allowed, even if 'rules' would normally block it
	- Deep packet analysis
		- packet analysis up to layer 7
	- User-based permissions
	- cisco device example: Cisco ASA w/ Firepower
+ Packet Filter
	- ACLs
	- non-stateful - the rules are just the rules
	- just would have to have wide-open ports
		- very unsecure
+ Routers can add Firewall functions to be both
	- better than ACLs
+ Encryption
	- 4 purposes
		-	Non-repudiation - can't deny authenticity
		- Confidentiality
		- Authenticity
		- Integrity
	- Symmetric
		- same shared key both encrypts and decrypts
		- fast
		- for large transmissions
			- email, https, vpn
		- AES, DES, etc. are examples
	- Asymmetric
		- private and public key pairs
			- only one key can decrypt the other
		- private key must be kept secret
		- slow
		- small transmissions
		- RSA, ECDSA, etc. are examples
		- Confidentiality example:
			- Public member encrypts with Public key
			- Private keyholder decrypts with Private key
		- Authenticity example:
			- Private keyholder encrypts with Public key
			- Public member decrypts with Public key
				- public member now knows it certainly came from the private keyholder
	- Hashing
		- HMAC - Hash-based Message Authentication Code
			- algorithm + shared key makes a code from the data, appended for reference after transmission to determine if data was altered
			- irreversible - no way to transform the code to the original data
			- shared key between sender and receiver
			- receiver hashes the data with the same algorithm and it's key
				- if same result, data wasn't changed
			- fast
			- SHA, MD5, CRC32 etc. are examples
		- normal Hashing
			- no key, just the algorithm
	- Key Distribution
		- can't send shared keys over the same internet channel - it's not secure
		- PKI - Public Key Infrastructure
			- trusted server is a middle-man that authenticates traffic
				- trusted server 'Certificate Authority'
				- co's send out a cert signed by CA's private key, saying it's legit traffic
					- co's public key
					- CA's public key
					- CA's private key signature (different for each company)
					- co's website address
				- browser already trusts all the CA's and uses their public keys
				- Co. also authenticates itself by sending a private key signature, you decrypt with public key
				- CA's already verified co's via offline communication
+ VPN security
	- Site-to-Site VPN
		-symmetric encryption, AES, DES, etc.
		- Certs or Preshared Key
			- Certs are better
				- Don't want one password for all tunnels
				- more scalable
			- Preshared key is still common in practice
	+IPsec
		- open standard for how to encrypt ip traffic for vpn
		- IKE - Internet Key Exchange
			- negotiation of protocols and algorithms
			- generates the encryption keys
		- ISAKMP - Internet Security Association and Key Management Protocol
			- procedures for authenticating and communicating peer connectivity
				- "and management of security associations"
			- often uses IKE for key exchange
		- AH mode - Authentication Header
			- no confidentiality
			- authentication, integrity
			- protection from replay attacks
		- ESP mode - Encapsulation Security Payload
			- confidentiality, authentication, integrity
			- protection from replay attacks
			- most common
		- ESP Tunneling mode
			- whole packet is encapsulated by new ip headers for vpn transport, original routing preserved after deencapsulation
			- most common
		- ESP Transport mode
			- only payload and ESP trailer are encrypted, IP header is not
			- for client-to-site VPN scenarios
			- usually when there's already a tunneling protocol used that doesn't encrypt (GRE, L2TP)
				- IPsec ESP Transport mode is then used to protect those tunnel packets, encapsulation on encapsulation
	- Steps
		- identify which traffic to protect and tunnel
		- IKE Phase 1 - vpn devices negotiate authentication policy with IKE
		- ISAKMP Phase 2 - vpn devices setup a secure connection with encryption via IPsec
		- traffic sent
	- Client-based VPN
		- Cisco ASA is the official product
		- uses TLS for encryption
		- 2 types
			- Split Tunneling
				- corporate network goes through vpn tunnel
				- internet traffic doesn't go through vpn tunnel
			- Full Tunneling
				- all traffic from the laptop goes to your vpn router/firewall
					- all traffic touches your corporate network
						- if internet destination, sent back out to that destination
							- everything is tunneled basically
+ Other security Cisco Products
	- ESA - Email Security Appliance
	- WSA - Web Security Appliance

+ Other Vulnerability Areas
	- DDoS - massive denial of service attack, ping flooding, etc.
		- protect via dispersed geographical hosting
	- Spoofing IPs
		- Unicast Reverse Path Forwarding (uRPF) protects against this
			- verifies a source IP address is reachable through the same interface port it was received on
		- TCP counters should be random and not easily guessable

>>>VPN Setup
IKE Phase 1:
crypto isakmp policy 1							[create policy 1]
(config-isakmp)# encr aes						[authenticate with AES crytpo algorithm]
(config-isakmp)# hash sha						[authentication hash with SHA algorithm]
(config-isakmp)# authentication pre-share		[pre-shared keys for authentication]
(config-isakmp)# group 2						[encryption algorithm diffie-helman is used for the pre-shared key]
(config-isakmp)# lifetime 86400					[a new key will be created every day (default)]
(config-isakmp)# crypto isakmp key <preshared key> address 203.0.113.5	[this preshared key is just for initial setup]

ip access-list extended VPN-ACL					[ACL to define vpn traffic]
(config-ext-nacl)# permit ip 10.10.10.0 0.0.0.255 10.10.20.0. 0.0.0.255

Now do the same for Router2 on the other side!

ISAKMP Phase 2:
crypto ipsec transform-set VPN-TransformSet esp-aes esp-sha-hmac
				[encapsulate with ESP using AES encryption, and ESP using SHA for HMAC]
crypto map VPNCM 10 ipsec-isakmp				[create a list of settings named 'VPNCM']
(config-crypto-map)# set peer 203.0.113.5		[public ip of the router on the other side]
(config-crypto-map)# set transform-set VPN-TransformSet
(config-crypto-map)# match address VPN-ACL

ip access-list extended NAT-ACL					[get into your router's NAT ACL]
(config-ext-nacl)# deny ip 10.10.10.0 0.0.0.255 10.10.20.0 0.0.0.255	[exclude vpn traffic]
(config-ext-nacl)# permit ip 10.10.10.0 0.0.0.255 any					[permit non-vpn traffic for that subnet going to anywhere else than your target subnet]

interface Serial1/1/0							[outgoing port facing the internet]
(config-if)# crypto map VPNCM					[use VPNCM settings for vpn]


-----------------------
Security Best Practices
-----------------------

+Banner Warnings
(config) banner login " [hit enter here]
Enter TEXT message. End with the character ".

+Disable unused services
    - HTTP
(config) no ip http server
    - CDP in super-secure environments
(config) no cdp run

+Syncrhonize Time
    - kerberos and digital certs require this
        - 5 minute difference causes failure
    - NTP server

+change default SNMP community strings

>>>NTP Setup
Router1(config) clock timezone PST -8                  [choose timezone]
Router1(config) ntp server 10.0.1.100                  [configure router to be an NTP client, NOT a server]
or
Router1(config) ntp master                             [configure router to be an NTP server]

#show clock                                             [it takes a bit of time for the time to correct!]
#show ntp status


=========================
Cisco Device Management
=========================
+CDP Cisco Discovery Protocol
    shows info of devices at the other end of the wires. each device sends out info to neighbors    
    multicast MAC address 0100.0CCC.CCCC
        not forwarded, it's received and information is updated
    v2 enabled by default
        messages every 60s
        180s information duration
    phones, routers, firewalls, switches use it too
    even shows operating system version of neighbors

# show cdp                                               [show cdp version and timer settings]
# show cdp traffic                                       [show amounts of cdp traffic received] [doesn't work in packet tracer]
# show cdp interface                                     [show interface info of each port using cdp
# show cdp neighbors                                     [shows list of devices and their ports connected to your ports]
# show cdp neighbor detail                               [shows details, including ip]
# show cdp entry {hostname}                              [shows details for one neighbor]
(config)# no cdp run                                     [shut off cdp]
(config-if)# cdp enable                                  [turn on for a single interface, or 'no' to turn off]
(config)# cdp timer 60                                   [cdp info sends every 60s]
(config)# cdp holdtime 120                               [cdp info stays for 120s]
(config)# no cdp advertise-v2                            [turn off version 2] [doesn't work in packet tracer]

+LLDP Link Layer Discovery Protocol
    non-cisco generic version of CDP
    can run both CDP and LLDP
    multicast MAC address 0180.C200.000E
    messages sent every 30s
    info stays for 120s
    Have to turn on globally and for each interface
    Sending and receiving are two different enable commands 

(config)# lldp run
(config-if)# lldp transmit                                [interface will send lldp messages]
(config-if)# lldp receive                                 [interface will receive lldp messages]
(config)# lldp timer 60
(config)# lldp holdtime 120
        


General Logging
-------------------------
+Cisco devices follow the Syslog logging format
(config) logging console - default config that sends events to the screen for all console users
(config) logging monitor - default config that tells the device to send log descriptions to all logged in users, but not unless:
(config) terminal monitor - command to force remote users to see logging events displayed
(config) logging buffered - save copies of logs in RAM
    > show logging - see copies of logs in RAM
(config) logging <hostname / address> - send logs to syslog server name or ip address

logging console <level> - only log events of this level and higher importance
logging monitor <level> - only show 
logging buffered <level> - only log events of X to 0 to RAM
logging trap <level>    - only log events of level X to 0 to syslog server

undebug all             - turn off debugging for everything
u all                   - same as undebug all

+Syslog
-------------------------
- Format:
seq no:time stamp: %facility-severity-MNEMONIC:description
[time] [time stamp] [object] [severity] [short description] [long description]

- Example:
*Oct 3 00:44:12.627: %LINK-5-CHANGED: Interface
FastEthernet0/0, changed state to administratively down

- Severity levels
    0. Emergency        system unusable
    1. Alert            correct immediately. ex. corrupted database
    2. Critical         ex. hard drive error
    3. Error            non-critical error
    4. Warning          think about what you're doing
    5. Notice           normal but significant conditions, which may require special handling
    6. Informational    something worked, some useful info
    7. Debug            detailed system actions for review
    Every Awesome Cisco Engineer Will Need Ice cream Daily

+SNMP - Simple Network Management Protocol
-------------------------
SNMP Manager - SNMP server
SNMP Server - common term for SNMP Manager
NMS - Network Management System - same as SNMP Server
SNMP Agent - software agent running on a client, to run SNMP on the network device
- Get - SNMP Manager pulls info from devices
- Trap - SNMP client pushes info to the SNMP Manager
- rarely the SNMP server may change info on an SNMP client to change device behavior
MIB - Management Information Database
- all devices using SNMP have a database with shared info tables, like routing tables on all devices
Community Strings - password shared between client and server, used by the software.
ro - read only community string
rw - read and write community string - this community can update the info database spread on
SNMPv1 - plain text authentication with Community Strings
SNMPv2c - still plain text Community Strings.  Supports bulk retrieval.
SNMPv3 - strong encryption supported, users and groups instead of community strings
    - user has to be configured on all devices and the server
    - 3 security levels
        - NoAuthNoPriv - no password or encryption
        - AuthNoPriv - password used, authentication is encrypted, further info exchange not encrypted
        - AuthPriv - password used, auth encrypted, transfers encrypted
    - views
        - limit information accessible to the snmp server
        - the server has read-only access by default
        - if no read view is specified, all snmp info objects can be read by the server
        - if no write view is specified, all snmp no objects can be updated by the server
        - notify view is disabled by default. It sends notifications to members of the group 


>>>SNMPv2c Setup
Router1(config) snmp-server community P4ssW0rd1 ro              [create read-only shared password]
Router1(config) snmp-server community Pa55word2 rw              [create read+write shared password]

Router1(config) snmp-server host 10.0.0.100                     [assign snmp server]
Router1(config) snmp-server enable traps config                 [optional - allow pushes from clients to server]

>>>SNMPv3 Setup
Router1(config) snmp-server group <groupname> v3 <auth/noAuth/priv>     [create group with groupname using snmpV3 and a chosen access level]
Router1(config) snmp-server user <username> <groupname> v3 auth <md5/sha> <auth password> priv aes 128 <transfer password>
                            [create username in groupname, choose hash method, user auth password, encryption level, de-encryption transfer password]


=========================
Quality of Service
=========================
+needed because of VoiP
    - voice and video were on separate networks. No longer. Congestion issues.

+More bandwidth costs $$$, so Quality of Service techniques help efficiency

+Quality Requirements recommended
    - Latency - 150ms - delay
    - Jitter - 30ms - variation in delay
    - Loss - 1%
    - HD video has stricter requirements

+Data is First in First Out

+Congestion occurs often in:
    - left to right traffic from HQ to a branch
    - wireless router from external to internal

+Effects of congestion:
    - delay is from waiting in the queue due to congestion
    - jitter is from the size of the queue changing
    - if the queue is full a new packet will be dropped

+Quality of Service Techniques
    - QoS Queuing
        - put video/voice packets to the front, deprioritizing data services
        - for temporary congestion issues
        - permanent congestion should be solved by increased bandwidth
        - ~80% utilization would be an example cutoff for QoS vs bandwidth increases

+Classification and Marking
    - voice and video endpoints mark their own traffic
    - other applications will have to be configured at the switch or router
    - CoS - Class of Service - Layer 2
        - 3 bit field in 802.1q layer 2 frame header for CoS marking
        - value of 0-7 can be set
            - default is zero, "best effort" traffic, higher is more prioritized
            - CoS 6 and 7 are reserved for network use
            - ip phones mark their call signaling traffic as 3 and voice payload as 5
    - DSCP - layer 3
        - 1 byte for ToS Type of Service in layer 3 ip header
        - 6 bits are used for 64 possible values
            - default is zero which is "best effort" traffic
        - ip phones mark call signaling as 24 ('CS3') and voice payload as 46 ('EF')
            - there are standards for mar
king other payloads, such as:
                - 26 ('AF31') - mission critical data
                - 34 ('AF41') - SD video
                - 'CS4' - HD video

+Trust Boundary
    - trust traffic from the phone, but not the PC
        - User could try to change the designated markings
            - mark this PC traffic down to CoS 0 and DSCP 0

+Recognizing Traffic with ACLs
    - layer 3 and layer 4 info can be used with ACLs to identify traffic

+Recognizing Traffic with NBAR
    - NBAR - Network Based Application Recognition
        - downloads signatures from Cisco, just like antivirus software, recognize that traffic
            - layer 3 to layer 7 info

+ DSCP is the preferred method
    - because it's looking at one byte in the ip header - a lot less work than NBAR
    - If non-DSCP method is used, do it as close to the source as possible, then DSCP value added there

+ CBWFQ - Class Based Weighted Fair Queing
    - bandwidth guarantees to specific types of traffic
        (config) bandwidth percent 5 - guaranteed 5% of bandwidth for this traffic - no other traffic uses it
+ LLQ - Low Latency Queuing
    - CBWFQ but with priority as well
        (config)# priority percent 33 - gives priority for this traffic for 33% of the bandwidth and also limits to that %

+MQC Modular CLI
    - Cisco QoS config uses the MQS modular command line interface
    - 3 main sections
    - Class maps define the traffic
    - Policy maps define the action for the traffic
    - Service Policies apply the policy to the interface

+Shaping and Policing Traffic Policies
    - Policing is dropping or remarking after limits are exceeded
        - used on the provider side
        - more aggressive than shaping
    - Shaping is buffering excess traffic so overall traffic stays within limits
        - used on the customer side
    - Examples:
        - limiting traffic per customer on leased-lines by the service provider
            - policing.  Excess traffic is dropped
        - limiting junk traffic you notice on your network
            - shaping. limit the rate so bad it's useless
            - DSCP 8 is the marking for this
    - policies must also be applied to the interface port
    - one policy per port, but can be nested for shaping policies


=========================
Automation
-------------------------
+REST APIs aka RESTful APIs
    - REpresentational State Transfer APIs
    - 6 requirements
        - client/server architecture
        - stateless operation 
            - history and other requests are meaningless
        - clear statement of cacheable/uncacheable
            - and timeframe for refreshing cached objects
        - uniform interface
        - layered
        - code-on-demand
    - http often used
        [IP tag][TCP tag][HTTP--Request Header {verb, URI}:Other Headers{extra parameters}:Data]
        - URI = https://dnac.example.com/dna/intent/api/v1/network-device?parm1=10.1.1.1
            - dnac.example.com = hostname
            - /dna/intent/api/v1/network-device = resource
            - ?parm1=10.1.1.1 = parameters a.k.a query
        - authentication would be in the "other headers" segment
        - Requests are via POST,GET,PATCH/PUT,DELETE
        - Responses would be in JSON or XML

+python
    - "keys" (a term) : "values" (of the term)
        ex: "config_speed": "auto",
    - data structure = "dictionary"

+4 actions of software vs HTTP verbs
    - CRUD, the 4 actions applications perform // HTTP verbs for them
        - create // POST (sometimes PATCH or PUT)
        - read   // GET
        - update // PATCH, PUT (sometimes POST)
        - delete // DELETE

+JSON and XML = Serialization
    - putting code variables into text values that can be saved on a file instead of code
    - REST client --> API Call --> REST Server --> JSON response --> Client converts into its own coding language
    - You only need to know JSON
    - JSON = Javascript Object Notation
        - Key:Value Pair
            - the Value Pair is whatever and everything after the quote or inside the array until the next Key
            - "key": {
                        "value pair subset 1": "value 1",<--- also counts as its own key:value pair (inside another one)
                        "value pair subset 2": "value 2",
                      }
    - XML = http style <key>value</key>
        - old, less used now
    - YAML is used by Linux automation Ansible, Puppet, Chef
        - JSON with less quotations and no commas, basically

+Configuration Drift = devices having different configurations over time (b/c of break-fixes, etc.)

+Ansible
    - Playbooks - logic
        - can do extra tasks if errors occur, etc.
    - Inventory - device info
    - Jinja2 language for templates
    - YAML for variables file, complementing the template
    - agentless
    - SSH or NETCONF to make changes
    - "push" model
    - linux server

ex: Jinja2 templates file
hostname {{hostname}} <---"variable"
!
interface GigabitEthernet0/0
 ip address {{address1}} {{mask1}}  <---two more variables
 ip ospf {{OSPF_PID}} area {{area}}
!
interface GigabitEthernet0/1
!
interface GigabitEthernet0/1/0
 ip address {{address2}} {{mask2}}
 ip ospf {{OSPF_PID}} area {{area}}

Ex: YAML variables file
hostname: BR1
address1: 10.1.1.1
mask1: 255.255.255.0
address2: 10.1.12.1
mask2: 255.255.255.0

+Puppet
    - Manifest - ideal device config
        - Module - subset of manifest
            - class - subset of module
                - resource - subset of class
    - Template - used to create manifests
    - centralized server
    - agent-based
        - if agent can't work, proxy server that uses SSH to make the changes agentless
    - "pull" model - agents pull configs from the central server

+Chef
    - like Puppet but can't be agentless, so doesn't work for all cisco devices
    - central server and probably a few workstations to make the configs
    - Recipes - configs
    - Cookbooks - set of recipes
    - Runlist - order of recipes to be used for a device
    - Resource - device

+Planes
    - Data Plane - moves data from one interface to another, ex. NAT, Hub, Switch auto-forwarding, Router route selection
    - Control Plane - determines data plane, ex. OSPF, ARP table, MAC table
    - Management Plane - supports or creates control plane, ex. IOS, SNMP, NTP, SSH, Syslog
    - Application Plane - creates scripts that control the management and control planes - Ansible is not on the Management plane!

+SDN - Software Defined Networking - Network Controller - centralized router basically ("automation")
    Router1 <----routing tables--- Network Controller ----routing tables---> Router2
    centralizes the CONTROL PLANE
    OSPF etc. exist in every router
    This just keeps control in one spot instead
    SouthBound Interface (SBI) - Network Controller API sending to the routers
        - OpenFlow
        - Opflex        
        - NETCONF
        - or SSH, SNMP, Telnet
    NorthBound Interface (NBI) - Network Controller REST API sending requests to applications, sysadmins use it to change the Controller
        - RESTCONF    
    Really helps with ACLs


+RESTCONF
    - REST API protocol for changing network configs
    - stateless
    - https
    - XML & JSON

+NETCONF
    - XML protocol for changing network configs
    - stateful
    - XML
    - SSH

+CISCO Products
    - SD-Access - LAN automation
    - SD-WAN - WAN automation
    - DNA Center - heart of both - the network controller
    - VXLAN (virtual extensible LAN) is used for tunneling data across everywhere

+Underlay - physical network
+Overlay - virtual network
+Fabric - overlay+underlay - the virtual and physical network
+Switch types in SDN
    - Edge nodes - connect to pc's and servers
    - Border nodes - connect to outside devices, such as internet gateway
    - Control nodes - Use LISP (Locator ID Separation Protocol) to control
+brownfield deployment - put the product on existing environment
+greenfield deployment - use product with new environment
    - all layer 3 switches
    - IS-IS will be the routing protocol

+"intent-based networking" possible with the power of SDN
 

=========================
Memory of Cisco Devices
-------------------------
IOS image = flash memory (persistent)
startup-config = NVRAM (persistent)
running-config = RAM (goes away every restart)

=========================
Emergency install of BIOSdir
-------------------------
emergency-install usbflash0://filename


=========================
Copying to and from Flash and USB
-------------------------
dir flash:					[see files in flash]
dir flash:foldername			[see files in flash/foldername/]
copy flash: usbflash0:			[copy a file from flash memory to the usb]
enter the filename you want to copy to usb
hit enter to confirm


=========================
Real-life Practical Troubleshooting Etc.
-------------------------
Cable Test
switch# show interfaces status (to find port)
switch# #test cable-diagsnostics tdr interface --/-/-
switch# #show cable-diagsnostics tdr interface --/-/-

You almost never see up/down status anymore, where line interface is up but line protocol is down

=========================
Synonyms
-------------------------
MAC table, CAM table, Bridging table
gateway of last resort, default route
Multilayer switch, Layer 3 Switch

=========================
Saving Config Files, Bootup, Memory, & Recovery from Startup Failures
-------------------------
+copying another config file MERGES configs, it DOES NOT REPLACE
	'write erase' to delete all config files from NVRAM
		or 
		'erase startup config'
	'copy flash start' to copy a file into startup config

5 Sources of Memory in the device
ROM - for Bootup
Flash - OS image, VLAN database
NVRAM - Non-volitale RAM
RAM - 
External USB flash - your usb stick

ROM
	Power-On Startup Test - tests for hardware failures 1st step on starting up
	Bootstrap - start of Operating system
		if no OS image found, ROMMON prompts up (Rom Monitor) for recovery
			can boot from USB or an external TFTP server
Flash
	Where the OS image is
	VLAN database

NVRAM
	Where the saved config is stored

RAM
	Where everything is currently being used, not saved
	The running config is in RAM on the OS running in RAM also
	Flash OS image --> RAM, saved config --> RAM = running config
	

Factory reset= 
	write erase
	reload
	or
	erase startup config
	delete vlan.dat
	reload
Password Recovery
!	ctrl+break within the first minute of bootup, entering the ROMMON prompt
!	'confreg 0x2142' to bypass running config load on bootup
	reset to restart the bootup process
	now you're starting in a fresh running config, having bypassed startup config
	enter enable mode
	do not leave enable mode!
	save starting config to running config, not vice-versa!
	create a new 'enable secret' password
!	'config-register 0x2102' so the router will boot normally on next restart
	'copy run start' to save running config to starting config.

updating new OS
	download the new OS image, put it on a tftp server
	'copy tftp flash' to download it from the tftp server onto the switch
	delete the old OS image to ensure the new image is used, or used the boot system command
    (config)#boot system c2960-lanbasek9-mz.150-2.SE4.bin [tells the switch to use this file for the OS instead of the starting OS]


Real Factory Reset
	press the black button (MODE), hold it down while you're unplugging it
	plug it back in, let go of the black button
	new prompt appears:
		flash_init
		boot
	choose flash_init
	switch:
	type in
		SWITCH_IGNORE_STARTUP_CFG=1
	then
		boot flash:packages.conf
	put in your config
	copy run start
	hold down the mode button again
	reload
	hit enter
	wait until lights turn amber or the console says it's restarting system
	let go of the button
	choose flash_init
	type in
		SWITCH_IGNORE_STARTUP_CFG=0
	then
		boot flash:packages.conf

=========================
Acronyms
-------------------------
VIP - virtual IP


=========================
Port, Header, etc. Numbers
-------------------------
Ports
UDP 67      - DHCP server
UDP 68      - DHCP client (the pc receiving and requesting info)
UDP 514         - Syslog
1812		- Radius

Port ranges
    Well-known	0 - 1024
    Registered	1025 - 49151
    Private	49152 - 65535

IP Headers
	IP Protocol Number - layer 3 packet header tells the layer 4 segment what type of protocol is being used
		6  - TCP
		17 - UDP
		41 - IPv6 encapsulation (6to4 and 6in4)
		89 - OSPF

Administrative Distances
    Static Route 1
    EIGRP 90
    OSPF 110
    RIP 120
    BGP 200

STP costs   Speed       STP Cost
           10 Mbps      100
          100 Mbps      19
            1 Gbps      4
           10 Gbps      2

224.0.0.5 - OSPF multicast sent by DR
224.0.0.6 - OSPF multicast reply by others

018.0c200.0000 - RPVST MAC address multicasted

Standard, Extendend, or Named ACLs
		List # range		classification		functionality
		1-99				Standard			source ip only!
		100-199				Extended v.2		port, source ip, destination ip
		1300-1999			Standard			source ip only
		2000-2699			Extended v.2		port, source ip, destination ip

Wifi
Standard    Frequency   Max Data Rate (theoretical)     Alternate Name
--------    ---------   ---------------------------     --------------
802.11      2.4ghz      2mbps
802.11b     2.4ghz      11mbps
802.11a     5ghz        54mbps
802.11g     2.4ghz      54mbps
802.11n     2.4 / 5ghz  600mbps                         'Wi-Fi 4'
802.11ac    5ghz        6.93Gbps                        'Wi-Fi 5'
802.11ax    2.4/5/6ghz  27.72Gbps                       'Wi-Fi 6'

IPv6 Multicasts
    IPv6        IPv4        Purpose    
    FF02::1     224.0.0.1   all nodes/hosts (like broadcast)
    FF02::2     224.0.0.2   all routers
    FF02::5     224.0.0.5   all ospf routers
    FF02::6     224.0.0.6   all ospf dr/bdr's
    FF02::9     224.0.0.9   all rip routers
    FF02::A     224.0.0.10  all eigrp routers
    

=========================
Standards Names
-------------------------
802.1q - VLAN, RSTP
802.1D - STP
802.1w - RSTP orginial
802.1q - RSTP new (same but in VLAN standard now)
802.1s - multiple spanning tree
802.3 - ethernet
802.3ab - Gigabit 125mb
802.3af - Power over Ethernet
802.3an - 10GB 1250mb
802.3u - autonegotiation
802.3z - Giabit Fiber 125mb
802.11 - wifi, 2.4 Ghz, 2mbps
802.11a - wifi, 5 Ghz, 54mbps
802.11b - wifi, 2.4 Ghz, 11 mbps
802.11g - wifi, 2.4 Ghz, 54 mbps
802.11n - wifi, 2.4 & 5 Ghz, 600 mbps - HT High Throughput
802.11ac - wifi, 5 Ghz, 6.93 Gbps - VHT Very High Throughput
802.11ax - wifi, 2.4 Ghz and 5 Ghz, 4x6.93 Gbps - "Wi-fi 6", more bands to be added

RFC 5424 - Syslog


=========================
User Access
-------------------------
! All of this has to be done in the config global
+ Telnet is disabled by default
+ aaa-new-model = local usernames and passwords can be used if other AAA settings haven't defined that area yet
+"aaa authentication enable default" = must authenticate again when trying to get to 'enable' privileges
+ you can define "enable" keyword as a fallback method. In case tacacs goes down you'll be able to get "enable" privileges by authenticating with the locally defined password.

+3 possible password gates:
    - Entry to line con 0, the physical console connection
    - Entry to line vty 0-15, the ssh or telnet remote terminal connections
    - Granting of Enable mode

+ enable password [password]			[create a general-use password for "enable" privileged access, unencrypted]
    - passwords must start with a letter, can be up to 25 characters, and any spaces other than beginning spaces work!
+ enable secret [password] 				[create encrypted general-use password for "enable" privileges]
    - this supersedes the unencrypted password, if configured
+ login							[enforce any user to use the general use passwords, no specific usernames are attributed]
	conf t
	line vty 0 15
	login
+ login local						[logins required and must use local usernames and passwords]
	config terminal
	line vty 0 15
	login local
+ username johndoe secret cisco			[create username johndoe with encrypted password cisco]

+ Careful not to enforce "login" or "login local" before you've defined usernames and passwords!

+ Local user-based passwords on the Switch:
- Switch> enable
  Switch# config t
  Switch(config)# aaa new-model		[enable authentication, authorization, accounting for users]
  Switch(config)# aaa authentication login default local	[any "default" (lowest-tier) login requires a username/password]
  Switch(config)# aaa authentication login exec default local	[any "enable" (priviliged) authorization requires user/password]
  Switch# username rick privilege 15 secret morty	[rick's access level is 15 (highest), rick's encrypted password is morty]
  Switch# username sanchez secret morty [sanchez's password is morty]

+ Local shared passwords on the Switch:	
- Switch# configure terminal
	- Switch(config)# enable secret love	[password for privileged "enable" access is now "love"]
	  Switch#(config)# line console 0	[change to console 0]
		- Switch#(config-line)# password faith	[password for console (serial/non-ethernet) login is now "faith"]
		  Switch#(config-line)# login		[type in new password]
		  Switch#(config-line)# exit		[back to config, exit console line 0]
		- Switch#(config)# line vty 0 15	[enter config for lines vty 0 15, all 16 virtual terminal lines]
		  Switch#(config-line)# password hope	[all 16 virtual terminal lines now require "hope" to login]
		  Switch#(config-line)# login		[type in new password]
		  Switch#(config-line)# end
- These are also stored in plain text! so dumb

+ Switch(config)# service-password encryption       [encrypt ALL passwords in the running-config.  A must have.]

+inactive logout is forced after 10 minutes by default
    Switch# no exec-timeout                 [disable inactive logout ejection]
    Swtich# exec-timeout 0                  [allow infinite inactivity before logout ejection]
    Switch# exec-timeout 15                 [15 minutes of inactivity leads to ejection]

+ACLs can restrict login to only admin ip's
R1(config) access-list 1 permit host 10.0.0.10
R1(config) line vty 0 15
R1(config-line) access-class 1 in           [enable the access list for this interface]

+Privilege Levels
    - 16, 0-15, given to user
        - Default is 1
    - each privilege level can be given a password for direct access to that privilege level
    - each command can be assigned a privilege level, allowable based on the user's privilege level
    - Default has three privilege levels
        - zero, user, privileged access levels
            - zero level privilege: only logout, enable, disable, help, exit
            - user level (level 1) is User Exec Mode: read-only access to limited commands
            - privileged level (level 15) is full access
    - if you don't have the privilege level, it won't tell you, it will say "invalid command"

SW1(config) username admin1 privilege 15 secret P4SSW0RD1!      [give user 'admin1' level 15 access with an encrypted password P4SSW0RD1!]
SW1(config) line console 0                                      
SW1(config) login local                                         [make users login with their local passwords when accessing via console]
SW1(config) line vty 0 15
SW1(config) login local                                         [make users login with their local passwords when accessing via remote terminal]

SW1(config) privilege exec level 5 show-running config          [level 5 privilege access or above is needed to use this command]

SW1> enable 5                                                   [ask for level 5 privileges]
SW1> enable 2                                                   [ask for level 2 privileges]
SW1> enable                                                     [ask for level 15 privileges]

SW1(config) enable secret P4ssW0rd                              [when users try to turn on enable mode, they use this password]
SW1(config) enable secret level 5 2ndP4ssW0rd                   [when users try to access level 5 privilege commands, they use this password]


-------------
AAA - Authentication, Authorization, and Accounting
-------------
+Authentication - proving identity
+Authorization - granting access
+Accounting - logging

+You want at least 2 AAA servers for redundancy

+TACACS+
    - more granular access control - privilege levels for each Cisco command

+RADIUS vs TACACS+
    - RADIUS for end user authentication, such as Wifi and VPN
    - TACACS+ for back-end AAA servers for administrator access on Cisco devices    
    - TACACS+ is proprietary to Cisco so RADIUS is often used instead for compatibility, but both are actually open standards

+ISE - Cisco's AAA server - Identity Service Engine


>>>RADIUS Setup
+NEW config for RADIUS
(config) aaa new-model                                          [use aaa]
(config) radius-server Server1                                  [enter radius server config for 'server1']
(config-radius-server) address ipv4 10.10.10.10                 [assign ip]
(config-radius-server) key R4D1USP4SSW0RD                       [shared password for the connection from servers and clients]
(config) radius-server Server2
(config-radius-server) address ipv4 10.10.10.11
(config-radius-server) key R4diusS3rv3r#2
(config-radius-server) aaa group server radius RadiusGroup1     [create a server group and enter the config menu for it]
(config-sg-radius) server name Server1                          [add the servers to the server group]
(config-sd-radius) server name Server2                          
(config) aaa authentication login default group RadiusGroup1 local    [use these servers for AAA]
or
(config) aaa authentication login default group local           [use all servers for AAA]



+Old RADIUS Config
(config) username BackupAdmin secret P4ssW0rd                   [create a backup admin user in case radius fails]
(config) aaa new-model
(config) radius-server host 10.10.10.10 key R4D1USP4SSW0RD      [assign the server and a shared password for the server and clients to use]
(config) radius-server host 10.10.10.11 key R4diusS3rv3r#2      [assign a second server for redundancy, and a shared password for the connection]
(config) aaa authentication login default group local           [use all servers for AAA]
                                                                [other groups can be created but it's not necessary]


=============
Beginner Commands Too Easy but Can't Forget
=============
(conf)# hostname EnterDeviceNameHere
>show version
(conf-if)#description Port Name,Description Goes Here



=============
Beginner Commandline
=============
exit			- leave to go one layer back in the terminal
end				- go all the way back to the base menu
ctrl+Z			- go all the way back to base menu
ctrl+C			- go all the way back to base menu
ctrl+shift+6	- stop pinging for god's sake
ctrl+]			- exit telnet


=============
+Don't Forget
=============
"copy run start" at the end of EVERY LAB on the test
for router interface configuration, you also need to add "no shutdown" or it's not enabled
interface RANGE fa 0/1 - 2    ---> (config-if-range)prompt, and any permutation of this command will work
"show vlan" only shows connected ports in access mode, not configured trunk ports
SVIs, switched virtual interfaces, only show on 'show ip int brief' and are named 'Vlan 10', but are router ports, not vlan configs
"ip routing" has to be enabled by this command on layer 3 switches and "no switchport" on all ports, if they will do routing instead
"ipv6 unicast-routing" isn't enabled by default

=============
CCNA Studying
=============
Jeremy's big megalab
personally - life of a packet + network port + pc port + websocket state-by-state, dhcp requirements + setup and failures
Learn NTP
NAT network address translation
Why can't I ping anything in the custom lab I created in packet tracer?
Jeremy's IT Lab labs are good
Boson study exam ExSim
Which commands don't require enable mode?
	review the stupid commands that you may need to know (disable, etc.)
Routing table inspection is huge
WPA3 on the test multiple times
OSPF - know what breaks
Wireless is everyone's weakspot, the study materials are not good enough
	- WLC GUI, knowing what to click on! lmao wtf
	- what happens when a controller fails
    - WLC, WLAN, basic security    
    ~ 7-10 questions on the exam
Lots of IPV6, API / controller, JSON formatting questions
IPV6
	configure IPv6 on all interfaces, including loopback
	verify connectivity in a lab setting
	understand IPv6 static, floating, recursive routes very well and how they work with multiple route entries available for routing
LLDP, LLDP-MED questions
ACLs
chef/puppet/ansible/JSON/XML/YAML for some easy answers
Subnet fast as hell
Questions were very tricky with 4 of the same answer just different CLI syntax
Boson sims are close to the test
Which commands have dashes and which ones don't?
Don't forget to "copy run start" at the end of the labs!
get free flashcards from https://courses.jeremysitlab.com/p/ccna and use Anki program for them
"ip routing" command sets a layer 3 switch to allow routing
review all ! rows on this file
Routing - which path will be picked?
Routing - which paths will be added to the routing table?
Output interpretation is important, seeing the show commands data and understanding issues
EIGRP is on the test

Memorize:
	- IEEE 80x.xx protocol names (ethernet, fast ethernet, vlan 801.q, etc.)
	- Copper cable pinouts RJ-45
	- admin distances (EIGRP 90, OSPF 110, RIP 120, BGP 200, etc.)



